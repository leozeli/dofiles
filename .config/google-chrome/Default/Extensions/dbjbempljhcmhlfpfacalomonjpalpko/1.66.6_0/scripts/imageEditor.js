/**
 * ImageAssistant
 * Project Home: http://www.pullywood.com/ImageAssistant/
 * Author: Joey
 * Copyright (C) 2013-2022 普利坞(Pullywood.com)
**/
"use strict";window._w_squall=null;window._w_horn="";window._w_consul=null;window._w_braid=null;window._w_threat=null;window._w_crack=[];window._w_bark=null;window._w_kennel=null;window._w_denim=null;window._w_equity=null;window._w_plume=null;chrome.tabs.getCurrent((function(tab){window._w_bark=tab.id;$(initEditor)}));window._w_mallet={timeout:512,lastExeTime:new Date,timer:null,updateStatics:false,delayAgain:true};window._w_nettle={timeout:2048,lastExeTime:new Date,timer:null,updateStatics:false,delayAgain:true};function _w_furrow(_w_throne,_w_barge){let _w_gutter="";if(!_w_throne.startsWith("data:image")){let _w_pest={};_w_pest[_w_throne]=_w_barge;_w_genre()._w_toll(_w_pest,_w_bark,true);_w_gutter=_w_throne.substring(_w_throne.lastIndexOf("/")+1)}else{_w_gutter="ia_"+_w_ire(16)+".png"}_w_phobia(_w_throne,_w_gutter,false,false)}function _w_leaven(_w_throne,_w_barge){if(!_w_throne.startsWith("data:image")){let _w_pest={};_w_pest[_w_throne]=_w_barge;_w_genre()._w_toll(_w_pest,_w_bark,true);$("#watermarkImageUrl").prop("value",_w_throne).attr("data-referer",_w_barge)}chrome.tabs.update(_w_bark,{active:true},(function(tab){chrome.windows.update(tab.windowId,{focused:true,drawAttention:false},(function(window){}))}));_w_icing(_w_throne,false)}function _w_phobia(_w_throne,_w_gutter,_w_chasm,_w_snarl){if(!_w_squall)_w_squall=new Image;if(_w_chasm){_w_lathe(_w_squall,_w_gutter,_w_snarl)}else{_w_squall.onload=function(){if(!_w_chasm){$("#scaleRate").prop("value",1);$("#scWidth").prop("value",_w_squall.width);$("#scWidth").attr("max",_w_squall.width);$("#scHeight").prop("value",_w_squall.height);$("#scHeight").attr("max",_w_squall.height);window._w_horn=_w_gutter}_w_lathe(this,_w_gutter,_w_snarl)};_w_squall.src=_w_throne}}function _w_icing(_w_aplomb,_w_chasm){if(!_w_equity)_w_equity=new Image;if(_w_chasm){_w_augur()}else{_w_equity.onload=function(){if(!_w_chasm){$("#wmImageCutUp").prop("value",null);$("#wmImageCutRight").prop("value",null);$("#wmImageCutDown").prop("value",null);$("#wmImageCutLeft").prop("value",null);$("#watermarkScaleRate").prop("value",1);$("#wmScWidth").attr("max",_w_equity.width).prop("value",_w_equity.width);$("#wmScHeight").attr("max",_w_equity.height).prop("value",_w_equity.height);$("#brToAlpha").prop("checked",false);$("#brToAlphaReverse").prop("checked",false).prop("disabled",true);$("#pixelAlphaRateRange").prop("value",1).prop("disabled",true);if(_w_aplomb==window._w_kennel.watermarkImageUrl){$("#wmImageCutUp").prop("value",window._w_kennel.imageCutUp);$("#wmImageCutRight").prop("value",window._w_kennel.imageCutRight);$("#wmImageCutDown").prop("value",window._w_kennel.imageCutDown);$("#wmImageCutLeft").prop("value",window._w_kennel.imageCutLeft);$("#watermarkScaleRate").prop("value",window._w_kennel.watermarkImageWidth/_w_equity.watermarkImageHeight);$("#wmScWidth").prop("value",window._w_kennel.watermarkImageWidth);$("#wmScHeight").prop("value",window._w_kennel.watermarkImageHeight);$("#brToAlpha").prop("checked",window._w_kennel.brToAlpha);$("#brToAlphaReverse").prop("checked",window._w_kennel.brToAlphaReverse).prop("disabled",window._w_kennel.brToAlpha?false:true);$("#pixelAlphaRateRange").prop("value",window._w_kennel.pixelAlphaRateRange).prop("disabled",window._w_kennel.brToAlpha?false:true)}}_w_augur()};_w_equity.src=_w_aplomb}}function _w_solo(){let _w_gorge=$("#qrCodeFgColor").prop("value");let _w_typo=$("#qrCodeBgColor").prop("value");let _w_butt=_w_colony(_w_typo);let _w_elm=parseInt($("#qrCodeAlpha").prop("value"))/100;_w_typo="RGBA("+_w_butt.r+", "+_w_butt.g+", "+_w_butt.b+", "+_w_elm+")";let _w_whit=$("#qrCodeSize").prop("value");let _w_opiate=$("#qrCodeText").prop("value");window._w_plume=_w_splint(_w_opiate,_w_whit,_w_gorge,_w_typo);setTimeout(_w_augur,256)}function _w_quest(){if(!window._w_kennel)window._w_kennel={};let _w_fabric=window._w_kennel;_w_fabric.textWatermark=$(".typeMenuItem.textWatermark").is(".active");_w_fabric.imageWatermark=$(".typeMenuItem.imageWatermark").is(".active");_w_fabric.qrCodeWatermark=$(".typeMenuItem.qrCodeWatermark").is(".active");_w_fabric.font=$("select#fontSelecter option:selected").prop("value");_w_fabric.fontSize=parseInt($("#fontSize").prop("value"));_w_fabric.fontColor=$("#fontColor").prop("value");_w_fabric.fontAlpha=parseInt($("#fontAlpha").prop("value"));_w_fabric.borderFont=$("#borderFont:checkbox").is(":checked");_w_fabric.text=$("#watermarkText").prop("value");_w_fabric.imageAlpha=parseInt($("#imageAlpha").prop("value"));if(_w_equity&&_w_breed(_w_equity.src)){_w_fabric.watermarkImageUrl=$("#watermarkImageUrl").prop("value");_w_fabric.watermarkImageReferer=$("#watermarkImageReferer").attr("data-referer");_w_fabric.imageCutUp=$("#wmImageCutUp").prop("value");_w_fabric.imageCutRight=$("#wmImageCutRight").prop("value");_w_fabric.imageCutDown=$("#wmImageCutDown").prop("value");_w_fabric.imageCutLeft=$("#wmImageCutLeft").prop("value");_w_fabric.watermarkImageWidth=$("#wmScWidth").prop("value");_w_fabric.watermarkImageHeight=$("#wmScHeight").prop("value");_w_fabric.brToAlpha=$("#brToAlpha").prop("checked");_w_fabric.brToAlphaReverse=$("#brToAlphaReverse").prop("checked");_w_fabric.pixelAlphaRateRange=$("#pixelAlphaRateRange").prop("value")}_w_fabric.qrCodeFgolor=$("#qrCodeFgColor").prop("value");_w_fabric.qrCodeBgolor=$("#qrCodeBgColor").prop("value");_w_fabric.qrCodeSize=$("#qrCodeSize").prop("value");_w_fabric.qrCodeAlpha=parseInt($("#qrCodeAlpha").prop("value"));_w_fabric.qrCodeBorder=parseInt($("#qrCodeBorder").prop("value"));_w_fabric.qrCodeText=$("#qrCodeText").prop("value");_w_fabric.tileWatermark=$(".presentationMenuItem.tileWatermark").is(".active");_w_fabric.locationWatermark=$(".presentationMenuItem.locationWatermark").is(".active");_w_fabric.offsetX=parseInt($("#offsetX").prop("value"));_w_fabric.offsetY=parseInt($("#offsetY").prop("value"));_w_fabric.marginX=parseInt($("#marginX").prop("value"));_w_fabric.marginY=parseInt($("#marginY").prop("value"));_w_fabric.rotate=parseInt($("#rotation").prop("value"));_w_fabric.alignX=parseInt($("#alignX").prop("value"));_w_fabric.alignY=parseInt($("#alignY").prop("value"));_w_fabric.middleAlignX=$("#middleAlignX").is(":checked");_w_fabric.middleAlignY=$("#middleAlignY").is(":checked");localStorage["watermarkConfigure"]=JSON.stringify(_w_fabric);window._w_kennel=_w_fabric}function _w_purity(){let _w_fabric=localStorage["watermarkConfigure"];if(_w_fabric&&_w_fabric.length>0){_w_fabric=JSON.parse(_w_fabric);$("select#fontSelecter option[value='"+_w_fabric.font+"']").attr("selected",true);$("#fontSizeRange,#fontSize").prop("value",_w_fabric.fontSize);$("#fontColor").prop("value",_w_fabric.fontColor);$("#fontAlphaRange,#fontAlpha").prop("value",_w_fabric.fontAlpha);$("#borderFont:checkbox").prop("checked",_w_fabric.borderFont);$("#middleAlignX").prop("checked",_w_fabric.middleAlignX);$("#middleAlignY").prop("checked",_w_fabric.middleAlignY);$("#watermarkText").prop("value",_w_fabric.text);$("#imageAlphaRange,#imageAlpha").prop("value",_w_fabric.imageAlpha);if(_w_fabric.watermarkImageUrl&&_w_breed(_w_fabric.watermarkImageUrl)){$("#watermarkImageUrl").prop("value",_w_fabric.watermarkImageUrl);$("#watermarkImageReferer").attr("data-referer",_w_fabric.watermarkImageReferer);$("#wmImageCutUp").prop("value",_w_fabric.imageCutUp);$("#wmImageCutRight").prop("value",_w_fabric.imageCutRight);$("#wmImageCutDown").prop("value",_w_fabric.imageCutDown);$("#wmImageCutLeft").prop("value",_w_fabric.imageCutLeft);$("#wmScWidth").prop("value",_w_fabric.watermarkImageWidth);$("#wmScHeight").prop("value",_w_fabric.watermarkImageHeight);$("#brToAlpha").prop("checked",_w_fabric.brToAlpha);$("#brToAlphaReverse").prop("checked",_w_fabric.brToAlphaReverse).prop("disabled",_w_fabric.brToAlpha?false:true);$("#pixelAlphaRateRange").prop("value",_w_fabric.pixelAlphaRateRange).prop("disabled",_w_fabric.brToAlpha?false:true)}$("#qrCodeFgColor").prop("value",_w_fabric.qrCodeFgolor);$("#qrCodeBgColor").prop("value",_w_fabric.qrCodeBgolor);$("#qrCodeSizeRange,#qrCodeSize").prop("value",_w_fabric.qrCodeSize);$("#qrCodeAlphaRange,#qrCodeAlpha").prop("value",_w_fabric.qrCodeAlpha);$("#qrCodeBorderRange,#qrCodeBorder").prop("value",_w_fabric.qrCodeBorder);$("#qrCodeText").prop("value",_w_fabric.qrCodeText);$("#offsetXRange,#offsetX").prop("value",_w_fabric.offsetX);$("#offsetYRange,#offsetY").prop("value",_w_fabric.offsetY);$("#marginXRange,#marginX").prop("value",_w_fabric.marginX);$("#marginYRange,#marginY").prop("value",_w_fabric.marginY);$("#rotationRange,#rotation").prop("value",_w_fabric.rotate);$("#alignXRange,#alignX").prop("value",_w_fabric.alignX);$("#alignYRange,#alignY").prop("value",_w_fabric.alignY);if(_w_fabric.watermarkImageUrl&&_w_fabric.watermarkImageUrl.length>0){if(!_w_fabric.watermarkImageUrl.startsWith("data:image")){let _w_pest={};_w_pest[_w_fabric.watermarkImageUrl]=_w_fabric.watermarkImageReferer;_w_genre()._w_toll(_w_pest,_w_bark,true)}_w_icing(_w_fabric.watermarkImageUrl,false)}if(_w_fabric.textWatermark){$(".typeMenuItem.textWatermark").trigger("click")}else if(_w_fabric.imageWatermark){$(".typeMenuItem.imageWatermark").trigger("click")}else if(_w_fabric.qrCodeWatermark){$(".typeMenuItem.qrCodeWatermark").trigger("click")}if(_w_fabric.tileWatermark){$(".presentationMenuItem.tileWatermark").trigger("click")}else if(_w_fabric.locationWatermark){$(".presentationMenuItem.locationWatermark").trigger("click")}window._w_kennel=_w_fabric}else{_w_slag()}}function _w_slag(){let _w_fabric={textWatermark:true,imageWatermark:false,qrCodeWatermark:false,font:"微软雅黑",fontSize:32,fontColor:"#000000",fontAlpha:50,borderFont:false,text:_w_tango("_w_awl"),imageAlpha:50,watermarkImageUrl:"https://www.pullywood.com/ImageAssistant/images/logo.png",watermarkImageReferer:"https://www.pullywood.com/",imageCutUp:null,imageCutRight:null,imageCutDown:null,imageCutLeft:null,watermarkImageWidth:128,watermarkImageHeight:128,brToAlpha:true,brToAlphaReverse:false,pixelAlphaRateRange:1,qrCodeFgolor:"#008000",qrCodeBgolor:"#ffffff",qrCodeSize:128,qrCodeAlpha:32,qrCodeBorder:10,qrCodeText:"https://www.pullywood.com/ImageAssistant/",tileWatermark:true,locationWatermark:false,offsetX:0,offsetY:0,marginX:32,marginY:32,rotate:-30,alignX:-20,alignY:-20,middleAlignX:false,middleAlignY:false};localStorage["watermarkConfigure"]=JSON.stringify(_w_fabric);_w_purity()}function _w_augur(){if(!_w_squall)return;_w_sprout(window._w_mallet,(function(){_w_phobia(_w_squall.src,_w_horn,true,false)}),false);_w_quest()}function _w_pyre(){if(!_w_equity||!_w_squall)return;_w_sprout(window._w_mallet,(function(){_w_icing(_w_squall.src,true)}),false);_w_quest()}chrome.runtime.onMessage.addListener((function(message,sender,callback){message&&message.type=="_w_faucet"&&_w_furrow(message._w_sermon,message._w_sluice);message&&message.type=="_w_prude"&&_w_leaven(message._w_sermon,message._w_sluice)}));function initEditor(){$("#header_link_container").append($("<a />",{class:"navbar-brand",text:_w_tango("_w_fusion")}).prepend($("<img />",{src:"./images/icon128.png",id:"brand_text"})));$("#navbar").append($("<ul />",{class:"nav navbar-nav navbar-right"}).append($("<li />").append($("<a />",{id:"_pullywood_home_",target:"_pullywood_",href:"https://www.pullywood.com/",text:_w_tango("_w_acuity")}).prepend($("<span />",{class:"glyphicon glyphicon-home"})))).append($("<li />").append($("<a />",{target:"_ImageAssistant_Plus_",href:"https://www.pullywood.com/ImageAssistant_Plus/",text:_w_tango("_w_truism")}).prepend($("<span />",{class:"fab fa-app-store"})))));$.getJSON(_w_hack,(function(data){let $_w_turret=$("#_cxyz_fav_");if(data.shortName){let _w_stitch=data.icon;let $_w_dome=$("<div />",{id:"popup_user_info"});let $_w_gale=$("<span />",{text:" [ "+data.shortName+" ] "});$_w_dome.append($_w_gale);$_w_turret.attr("href",_w_hack);$_w_turret.append($_w_dome)}else{}}));$("#imageLoader,#multipleImageInput").attr("accept","image/"+"*");document.onpaste=function(event){let _w_dither=event.clipboardData.items[0].getAsFile();if(!_w_dither.type||!_w_dither.type.startsWith("image"))return;let _w_consul=new FileReader;_w_consul.onload=function(event){_w_phobia(event.target.result,_w_condor(16),false,false)};_w_consul.readAsDataURL(_w_dither)};chrome.fontSettings&&chrome.fontSettings.getFontList((function populateFontList(fontArr){fontArr.sort().reverse();for(let key in fontArr){let _w_psalm=fontArr[key].displayName;_w_psalm=_w_psalm.replace(/^\s\s*/,"").replace(/\s\s*$/,"");if(_w_psalm.match(/[_\-\s]Italic$/)||_w_psalm.match(/[_\-\s](Demi)?[Bb]old$/)||_w_psalm.match(/[_\-\s]Medium$/)||_w_psalm.match(/[_\-\s](Ultra)?[Ll]ight$/)||_w_psalm.match(/[_\-\s]Condensed$/))_w_crack.push(_w_psalm);else{_w_crack.push(_w_psalm)}}let $_w_scale=$("#fontSelecter");for(let i=0;i<_w_crack.length;++i){let _w_psalm=_w_crack[i];$_w_scale.append($("<option />",{value:_w_psalm,text:_w_psalm,style:"font-family:"+_w_psalm+";",selected:window._w_kennel&&window._w_kennel.font&&window._w_kennel.font==_w_psalm}))}}));$(window).on("resize",_w_augur);$("#imageLoader").on("change",(function(funEvent){let _w_tenet=$(this).get(0).files;if(_w_tenet.length==0)return;let _w_trifle=_w_tenet[0];let $_w_boom=$(this);if(!_w_consul)_w_consul=new FileReader;_w_consul.onload=function(event){_w_phobia(event.target.result,_w_trifle.name,false,false)};_w_consul.readAsDataURL(_w_trifle)}));$("#scaleRate,#scWidth,#scHeight").on("change",(function(){let _w_candor=parseFloat($("#scaleRate").prop("value"));let _w_rivet=parseInt($("#scWidth").prop("value"));let _w_bubble=parseInt($("#scHeight").prop("value"));let _w_scamp=parseInt($("#scWidth").prop("max"));let _w_gnat=parseInt($("#scHeight").prop("max"));if($(this).is("#scaleRate")){_w_rivet=Math.round(_w_scamp*_w_candor);_w_bubble=Math.round(_w_gnat*_w_candor)}else if($(this).is("#scWidth")){_w_candor=_w_rivet/_w_scamp;_w_bubble=Math.round(_w_gnat*_w_candor)}else if($(this).is("#scHeight")){_w_candor=_w_bubble/_w_gnat;_w_rivet=Math.round(_w_scamp*_w_candor)}else{return}$("#scaleRate").prop("value",_w_candor);$("#scWidth").prop("value",_w_rivet);$("#scHeight").prop("value",_w_bubble);_w_augur()}));$(".typeMenuItem").on("click",(function(){$(".typeMenuItem").removeClass("active");$(this).addClass("active");$(".typeMenuTab").hide();if($(this).is(".textWatermark")){$(".typeMenuTab.textWatermark").show();_w_augur()}else if($(this).is(".imageWatermark")){$(".typeMenuTab.imageWatermark").show();_w_pyre()}else if($(this).is(".qrCodeWatermark")){$(".typeMenuTab.qrCodeWatermark").show();_w_solo()}}));$("#fontSelecter").on("change",(function(){_w_augur()}));$("#fontSizeRange,#fontSize").on("change",(function(){if($(this).is("#fontSizeRange")){$("#fontSize").prop("value",$(this).prop("value"))}else if($(this).is("#fontSize")){$("#fontSizeRange").prop("value",$(this).prop("value"))}else{return}_w_augur()}));$("#fontColor").on("input",(function(){_w_augur()}));$("#fontAlphaRange,#fontAlpha").on("change",(function(){if($(this).is("#fontAlphaRange")){$("#fontAlpha").prop("value",$(this).prop("value"))}else if($(this).is("#fontAlpha")){$("#fontAlphaRange").prop("value",$(this).prop("value"))}else{return}_w_augur()}));$("#borderFont").on("change",(function(){_w_augur()}));$("#watermarkText").on("change",(function(){_w_augur()}));$("#watermarkImage").on("change",(function(funEvent){let _w_tenet=$(this).get(0).files;if(_w_tenet.length==0)return;let _w_trifle=_w_tenet[0];let $_w_boom=$(this);if(!_w_denim)_w_denim=new FileReader;_w_denim.onload=function(event){_w_icing(event.target.result,false)};_w_denim.readAsDataURL(_w_trifle)}));$("#wmImageCutUp,#wmImageCutRight,#wmImageCutDown,#wmImageCutLeft").on("change",(function(){if(_w_equity==null)return;let _w_ford=parseInt($("#wmImageCutUp").prop("value"));_w_ford=_w_ford?_w_ford:0;let _w_boast=parseInt($("#wmImageCutRight").prop("value"));_w_boast=_w_boast?_w_boast:0;let _w_shoal=parseInt($("#wmImageCutDown").prop("value"));_w_shoal=_w_shoal?_w_shoal:0;let _w_vista=parseInt($("#wmImageCutLeft").prop("value"));_w_vista=_w_vista?_w_vista:0;let _w_scamp=_w_equity.width-_w_vista-_w_boast;let _w_gnat=_w_equity.height-_w_ford-_w_shoal;$("#wmScWidth").prop("max",_w_scamp);$("#wmScHeight").prop("max",_w_gnat);$("#watermarkScaleRate").trigger("change");_w_augur()}));$("#watermarkScaleRate,#wmScWidth,#wmScHeight").on("change",(function(){if(_w_equity==null)return;let _w_arson=parseFloat($("#watermarkScaleRate").prop("value"));let _w_poncho=parseInt($("#wmScWidth").prop("value"));let _w_outset=parseInt($("#wmScHeight").prop("value"));let _w_scamp=parseInt($("#wmScWidth").prop("max"));let _w_gnat=parseInt($("#wmScHeight").prop("max"));if($(this).is("#watermarkScaleRate")){_w_poncho=Math.round(_w_scamp*_w_arson);_w_outset=Math.round(_w_gnat*_w_arson)}else if($(this).is("#wmScWidth")){_w_arson=_w_poncho/_w_scamp;_w_outset=Math.round(_w_gnat*_w_arson)}else if($(this).is("#wmScHeight")){_w_arson=_w_outset/_w_gnat;_w_poncho=Math.round(_w_scamp*_w_arson)}else{return}$("#watermarkScaleRate").prop("value",_w_arson);$("#wmScWidth").prop("value",_w_poncho);$("#wmScHeight").prop("value",_w_outset);_w_pyre()}));$("#brToAlpha,#brToAlphaReverse").on("change",(function(){if($("#brToAlpha").is(":checked")){$("#brToAlphaReverse,#pixelAlphaRateRange").attr("disabled",false)}else{$("#brToAlphaReverse,#pixelAlphaRateRange").attr("disabled",true)}_w_augur()}));$("#pixelAlphaRateRange").on("change",(function(){_w_augur()}));$("#imageAlphaRange,#imageAlpha").on("change",(function(){if($(this).is("#imageAlphaRange")){$("#imageAlpha").prop("value",$(this).prop("value"))}else if($(this).is("#imageAlpha")){$("#imageAlphaRange").prop("value",$(this).prop("value"))}else{return}_w_pyre()}));$("#qrCodeFgColor").on("input",(function(){_w_solo()}));$("#qrCodeBgColor").on("input",(function(){_w_solo()}));$("#qrCodeSizeRange,#qrCodeSize").on("change",(function(){if($(this).is("#qrCodeSizeRange")){$("#qrCodeSize").prop("value",$(this).prop("value"))}else if($(this).is("#qrCodeSize")){$("#qrCodeSizeRange").prop("value",$(this).prop("value"))}else{return}_w_solo()}));$("#qrCodeAlphaRange,#qrCodeAlpha").on("change",(function(){if($(this).is("#qrCodeAlphaRange")){$("#qrCodeAlpha").prop("value",$(this).prop("value"))}else if($(this).is("#qrCodeAlpha")){$("#qrCodeAlphaRange").prop("value",$(this).prop("value"))}else{return}_w_solo()}));$("#qrCodeBorderRange,#qrCodeBorder").on("change",(function(){if($(this).is("#qrCodeBorderRange")){$("#qrCodeBorder").prop("value",$(this).prop("value"))}else if($(this).is("#qrCodeBorder")){$("#qrCodeBorderRange").prop("value",$(this).prop("value"))}else{return}_w_solo()}));$("#qrCodeText").on("input",(function(){_w_solo()}));$(".presentationMenuItem").on("click",(function(){$(".presentationMenuItem").removeClass("active");$(this).addClass("active");$(".presentationMenuTab").hide();if($(this).is(".tileWatermark")){$(".presentationMenuTab.tileWatermark").show()}else if($(this).is(".locationWatermark")){$(".presentationMenuTab.locationWatermark").show()}_w_augur()}));$("#offsetXRange,#offsetX").on("change",(function(){if($(this).is("#offsetXRange")){$("#offsetX").prop("value",$(this).prop("value"))}else if($(this).is("#offsetX")){$("#offsetXRange").prop("value",$(this).prop("value"))}else{return}_w_augur()}));$("#offsetYRange,#offsetY").on("change",(function(){if($(this).is("#offsetYRange")){$("#offsetY").prop("value",$(this).prop("value"))}else if($(this).is("#offsetY")){$("#offsetYRange").prop("value",$(this).prop("value"))}else{return}_w_augur()}));$("#marginXRange,#marginX").on("change",(function(){if($(this).is("#marginXRange")){$("#marginX").prop("value",$(this).prop("value"))}else if($(this).is("#marginX")){$("#marginXRange").prop("value",$(this).prop("value"))}else{return}_w_augur()}));$("#marginYRange,#marginY").on("change",(function(){if($(this).is("#marginYRange")){$("#marginY").prop("value",$(this).prop("value"))}else if($(this).is("#marginY")){$("#marginYRange").prop("value",$(this).prop("value"))}else{return}_w_augur()}));$("#rotationRange,#rotation").on("change",(function(){if($(this).is("#rotationRange")){$("#rotation").prop("value",$(this).prop("value"))}else if($(this).is("#rotation")){$("#rotationRange").prop("value",$(this).prop("value"))}else{return}_w_augur()}));$("#alignXRange,#alignX").on("change",(function(){if($(this).is("#alignXRange")){$("#alignX").prop("value",$(this).prop("value"))}else if($(this).is("#alignX")){$("#alignXRange").prop("value",$(this).prop("value"))}else{return}_w_augur()}));$("#alignYRange,#alignY").on("change",(function(){if($(this).is("#alignYRange")){$("#alignY").prop("value",$(this).prop("value"))}else if($(this).is("#alignY")){$("#alignYRange").prop("value",$(this).prop("value"))}else{return}_w_augur()}));$("#middleAlignX").on("change",(function(){if($(this).is(":checked")){$("#alignXRange,#alignX").attr("disabled",true)}else{$("#alignXRange,#alignX").attr("disabled",false)}_w_augur()}));$("#middleAlignY").on("change",(function(){if($(this).is(":checked")){$("#alignYRange,#alignY").attr("disabled",true)}else{$("#alignYRange,#alignY").attr("disabled",false)}_w_augur()}));$("#downloadCanvasImage").on("click",(function(){_w_phobia(_w_squall.src,_w_horn,false,true)}));$("#batchImage").on("click",(function(){$("#multipleImageInput").get(0).click()}));$("#openDownloadFolderBtn").on("click",_w_vogue);$("#multipleImageInput").on("change",(function(){let _w_tenet=$(this).get(0).files;let $_w_boom=$(this);let _w_quaver=Object.keys(_w_tenet);let _w_libido=_w_quaver.length;$(window).off("resize",_w_augur);let _w_otter=document.title;(function makeWM(){if(_w_quaver.length==0){document.title=_w_tango("_w_tariff")+_w_tango("_w_canard");setTimeout((function(){document.title=_w_otter}),2e3);$(window).on("resize",_w_augur);_w_augur()}else{document.title=_w_tango("_w_tariff")+(_w_libido-_w_quaver.length)+"/"+_w_libido;let _w_trifle=_w_tenet[_w_quaver.shift()];if(!_w_consul)_w_consul=new FileReader;_w_consul.onload=function(event){let _w_veil=(new Date).getTime();_w_phobia(event.target.result,_w_trifle.name,false,true);let _w_pine=(new Date).getTime();let _w_sentry=_w_pine-_w_veil;let _w_shrub=_w_sentry>256?_w_sentry*2:256;(function ctAction(){chrome.downloads.search({urlRegex:"^data:image/.*$",state:"in_progress"},(function(data){if(data.length>2){setTimeout(ctAction,_w_shrub)}else{makeWM()}}))})()};_w_consul.readAsDataURL(_w_trifle)}})()}));$("#resetConfigure").on("click",(function(){_w_slag();_w_augur()}));document.title=_w_tango("_w_prime");$("#editor_i18n_1001").html(_w_tango("_w_rascal"));$("#editor_i18n_1002").html(_w_tango("_w_gear"));$("#editor_i18n_1003").html(_w_tango("_w_panel"));$("#editor_i18n_1004").html(_w_tango("_w_snarl"));$("#editor_i18n_1005").html(_w_tango("_w_nova"));$("#editor_i18n_1006").html(_w_tango("_w_plane"));$("#editor_i18n_1007").html(_w_tango("_w_epoch"));$("#editor_i18n_1008").html(_w_tango("_w_mold"));$("#editor_i18n_1009").html(_w_tango("_w_nuance"));$("#editor_i18n_1010").html(_w_tango("_w_quest"));$("#editor_i18n_1011").html(_w_tango("_w_detour"));$("#editor_i18n_1012").html(_w_tango("_w_idol"));$("#editor_i18n_1013").html(_w_tango("_w_mime"));$("#editor_i18n_1014").html(_w_tango("_w_sock"));$("#editor_i18n_1015").html(_w_tango("_w_gibe"));$("#wmImageCutUp").attr("placeHolder",_w_tango("_w_tipple"));$("#wmImageCutRight").attr("placeHolder",_w_tango("_w_armada"));$("#wmImageCutDown").attr("placeHolder",_w_tango("_w_duet"));$("#wmImageCutLeft").attr("placeHolder",_w_tango("_w_dictum"));$("#editor_i18n_1020").html(_w_tango("_w_heresy"));$("#editor_i18n_1021").html(_w_tango("_w_tusk"));$("#editor_i18n_1022").html(_w_tango("_w_fetish"));$("#editor_i18n_1023").html(_w_tango("_w_beam"));$("#editor_i18n_1024").html(_w_tango("_w_pleat"));$("#editor_i18n_1025").html(_w_tango("_w_logjam"));$("#editor_i18n_1026").html(_w_tango("_w_mire"));$("#editor_i18n_1027").html(_w_tango("_w_inroad"));$("#editor_i18n_1028").html(_w_tango("_w_code"));$("#editor_i18n_1029").html(_w_tango("_w_unison"));$("#editor_i18n_1030").html(_w_tango("_w_swirl"));$("#editor_i18n_1031").html(_w_tango("_w_domain"));$("#editor_i18n_1032").html(_w_tango("_w_enmity"));$("#editor_i18n_1033").html(_w_tango("_w_famine"));$("#editor_i18n_1034").html(_w_tango("_w_yoke"));$("#editor_i18n_1035").html(_w_tango("_w_parka"));$("#editor_i18n_1036").html(_w_tango("_w_ruffle"));$("#editor_i18n_1037").html(_w_tango("_w_maple"));$("#editor_i18n_1038").html(_w_tango("_w_rebate"));$("#editor_i18n_1039").html(_w_tango("_w_nausea"));$("#editor_i18n_1040").html(_w_tango("_w_slant"));$("#editor_i18n_1041").html(_w_tango("_w_fault"));$("#editor_i18n_1042").html(_w_tango("_w_pygmy"));$("#editor_i18n_1043").html(_w_tango("_w_throne"));$("#editor_i18n_1044").html(_w_tango("_w_crutch"));$("#editor_i18n_1045").html(_w_tango("_w_delta"));$("#editor_i18n_1046").html(_w_tango("_w_shield"));$("#editor_i18n_1047").html(_w_tango("_w_gum"));_w_purity()}function _w_lathe(_w_thrall,_w_gutter,_w_snarl){if(!_w_braid)_w_braid=$("#canvas").get(0);let $_w_silt=$(_w_braid).parent();_w_braid.width=$("#scWidth").prop("value");_w_braid.height=$("#scHeight").prop("value");let _w_scamp=_w_braid.parentElement.offsetWidth;if(_w_braid.width<=_w_scamp){_w_braid.style.width=_w_braid.width+"px";_w_braid.style.height=_w_braid.height+"px";$("#displayRate").html(_w_tango("_w_stanza")+"100%")}else{_w_braid.style.width=_w_scamp+"px";_w_braid.style.height=_w_scamp/_w_braid.width*_w_braid.height+"px";$("#displayRate").html(_w_tango("_w_stanza")+(_w_scamp/_w_braid.width*100).toFixed(1)+"%")}if(!_w_threat)_w_threat=_w_braid.getContext("2d");_w_threat.drawImage(_w_thrall,0,0,_w_braid.width,_w_braid.height);let _w_tycoon=function(_w_pack){let _w_suture=$("#watermarkText").prop("value");if(_w_suture.length==0)return;let _w_quay=parseInt($("#fontSize").prop("value"));let _w_foible=_w_colony($("#fontColor").prop("value"));let _w_dismay=parseInt($("#fontAlpha").prop("value"))/100;let _w_ewe="rgba("+_w_foible.r+", "+_w_foible.g+", "+_w_foible.b+", "+_w_dismay+")";_w_threat.font=_w_quay+"px "+$("select#fontSelecter option:selected").prop("value");_w_threat.strokeStyle=_w_ewe;_w_threat.fillStyle=_w_ewe;let _w_corral={};_w_corral.width=_w_threat.measureText(_w_suture).width;_w_corral.height=_w_quay;_w_pack(_w_corral,(function(x,y){if($("#borderFont:checkbox").is(":checked")){_w_threat.strokeText(_w_suture,x,y+_w_corral.height)}else{_w_threat.fillText(_w_suture,x,y+_w_corral.height)}}))};let _w_tyrant=null;let _w_loft=function(_w_pack){if(_w_equity==null)return;if(_w_tyrant==null){let _w_ford=parseInt($("#wmImageCutUp").prop("value"));_w_ford=_w_ford?_w_ford:0;let _w_boast=parseInt($("#wmImageCutRight").prop("value"));_w_boast=_w_boast?_w_boast:0;let _w_shoal=parseInt($("#wmImageCutDown").prop("value"));_w_shoal=_w_shoal?_w_shoal:0;let _w_vista=parseInt($("#wmImageCutLeft").prop("value"));_w_vista=_w_vista?_w_vista:0;let _w_badge=_w_equity.width-_w_vista-_w_boast;let _w_larder=_w_equity.height-_w_ford-_w_shoal;let _w_levity=document.createElement("canvas");_w_levity.width=_w_badge;_w_levity.height=_w_larder;let _w_cob=_w_levity.getContext("2d");_w_cob.drawImage(_w_equity,_w_vista,_w_ford,_w_badge,_w_larder,0,0,_w_badge,_w_larder);if($("#brToAlpha").is(":checked")){let _w_hinge=$("#brToAlphaReverse").is(":checked");let _w_caveat=parseFloat($("#pixelAlphaRateRange").prop("value"));let _w_magpie=_w_cob.getImageData(0,0,_w_levity.width,_w_levity.height);let _w_coffer=_w_magpie.data.length;for(let i=0;i<_w_coffer;i+=4){let _w_fraud=.299*_w_magpie.data[i]+.587*_w_magpie.data[i+1]+.114*_w_magpie.data[i+2];let _w_pivot=_w_fraud;if(_w_hinge){_w_pivot=255-_w_pivot}_w_pivot=_w_pivot*_w_caveat;if(_w_magpie.data[i+3]>0)_w_magpie.data[i+3]=_w_pivot}_w_cob.putImageData(_w_magpie,0,0)}_w_tyrant=_w_levity}let _w_patch=parseInt($("#wmScWidth").prop("value"));let _w_arena=parseInt($("#wmScHeight").prop("value"));let _w_attic=parseInt($("#imageAlpha").prop("value"))/100;let _w_corral={};_w_corral.width=_w_patch;_w_corral.height=_w_arena;_w_pack(_w_corral,(function(x,y){_w_threat.save();_w_threat.globalAlpha=_w_attic;_w_threat.drawImage(_w_tyrant,0,0,_w_tyrant.width,_w_tyrant.height,x,y,_w_patch,_w_arena);_w_threat.restore()}))};let _w_fleece=function(_w_pack){if(window._w_plume==null)return;let _w_patch=window._w_plume.width;let _w_arena=window._w_plume.height;let _w_typo=$("#qrCodeBgColor").prop("value");let _w_butt=_w_colony(_w_typo);let _w_elm=parseInt($("#qrCodeAlpha").prop("value"))/100;_w_typo="RGBA("+_w_butt.r+", "+_w_butt.g+", "+_w_butt.b+", "+_w_elm+")";let _w_script=parseInt($("#qrCodeBorderRange").prop("value"));let _w_corral={};_w_corral.width=_w_patch+2*_w_script;_w_corral.height=_w_arena+2*_w_script;_w_pack(_w_corral,(function(x,y){let _w_coup=_w_threat.fillStyle;_w_threat.fillStyle=_w_typo;_w_threat.fillRect(x,y,_w_patch+2*_w_script,_w_arena+2*_w_script);_w_threat.fillStyle=_w_coup;_w_threat.drawImage(window._w_plume,0,0,window._w_plume.width,window._w_plume.height,x+_w_script,y+_w_script,_w_patch,_w_arena)}))};let _w_hangar=function(_w_pack){if($(".typeMenuItem.textWatermark").is(".active")){_w_tycoon(_w_pack)}else if($(".typeMenuItem.imageWatermark").is(".active")){_w_loft(_w_pack)}else if($(".typeMenuItem.qrCodeWatermark").is(".active")){_w_fleece(_w_pack)}};let _w_beam=function(){let _w_limb={};_w_limb.width=parseInt($("#marginX").prop("value"));_w_limb.height=parseInt($("#marginY").prop("value"));let _w_goblet=parseInt($("#rotation").prop("value"));let _w_vagary={};_w_vagary.x=parseInt($("#offsetX").prop("value"));_w_vagary.y=parseInt($("#offsetY").prop("value"));let _w_apiary=Math.sqrt(Math.pow(_w_braid.width+Math.abs(_w_vagary.x),2)+Math.pow(_w_braid.height+Math.abs(_w_vagary.y),2));let _w_pack=function(_w_corral,_w_draft){_w_corral.width+=_w_limb.width;_w_corral.height+=_w_limb.height;_w_threat.rotate(_w_goblet*Math.PI/180);for(let x=0;x<_w_apiary;x+=_w_corral.width){for(let y=0;y<_w_apiary;y+=_w_corral.height){_w_draft(x+_w_limb.width+_w_vagary.x,y+_w_vagary.y)}}for(let x=0;x<_w_apiary;x+=_w_corral.width){for(let y=-_w_corral.height;y>-_w_apiary;y-=_w_corral.height){_w_draft(x+_w_limb.width+_w_vagary.x,y+_w_vagary.y)}}for(let x=-_w_corral.width;x>-_w_apiary;x-=_w_corral.width){for(let y=-_w_corral.height;y>-_w_apiary;y-=_w_corral.height){_w_draft(x+_w_limb.width+_w_vagary.x,y+_w_vagary.y)}}for(let x=-_w_corral.width;x>-_w_apiary;x-=_w_corral.width){for(let y=0;y<_w_apiary;y+=_w_corral.height){_w_draft(x+_w_limb.width+_w_vagary.x,y+_w_vagary.y)}}};_w_hangar(_w_pack)};let _w_mania=function(){let _w_amulet=parseInt($("#alignX").prop("value"));let _w_gull=parseInt($("#alignY").prop("value"));let _w_nova=$("#middleAlignX").is(":checked");let _w_avowal=$("#middleAlignY").is(":checked");let _w_pack=function(_w_corral,_w_draft){let _w_timber={x:0,y:0};if(_w_nova){_w_timber.x=Math.round(_w_braid.width/2-_w_corral.width/2)}else if(_w_amulet>0){_w_timber.x=_w_amulet}else if(_w_amulet<0){_w_timber.x=_w_braid.width-_w_corral.width+_w_amulet+1}if(_w_avowal){_w_timber.y=Math.round(_w_braid.height/2-_w_corral.height/2)}else if(_w_gull>0){_w_timber.y=_w_gull}else if(_w_gull<0){_w_timber.y=_w_braid.height-_w_corral.height+_w_gull+1}_w_draft(_w_timber.x,_w_timber.y)};_w_hangar(_w_pack)};if($(".presentationMenuItem.tileWatermark").is(".active")){_w_beam()}else if($(".presentationMenuItem.locationWatermark").is(".active")){_w_mania()}_w_gutter="watermark_"+_w_gutter;_w_gutter=_w_gutter.replace(/^(.*?)(\.[\w]{3,4})?$/,"$1.png");let _w_grove=function(){blobUtil.canvasToBlob(_w_braid).then((function(blob){chrome.downloads.download({url:blobUtil.createObjectURL(blob),filename:_w_clam(_w_tango("_w_entry")+"/"+_w_gutter),saveAs:false,conflictAction:"uniquify"})}))};if(_w_snarl){_w_grove()}let _w_torpor=parseInt(_w_braid.style.width.replace("px",""));let _w_sledge=parseInt(_w_braid.style.height.replace("px",""));$(_w_braid).parent().off("mouseover mouseout mousemove");if(_w_torpor<_w_braid.width){let _w_cast=function(event){let _w_silt=$(_w_braid).parent().get(0);let _w_renown=_w_silt.offsetTop;let _w_pier=_w_silt.offsetLeft;let _w_fringe=event.pageX-_w_pier;let _w_gusher=event.pageY-_w_renown;let _w_recall=-(_w_braid.width-_w_torpor)*_w_fringe/_w_torpor;let _w_planet=-(_w_braid.height-_w_sledge)*_w_gusher/_w_sledge;$(_w_braid).css("margin-top",_w_planet);$(_w_braid).css("margin-left",_w_recall)};$(_w_braid).parent().on("mouseover",(function(event){$(_w_braid).css("width",_w_braid.width);$(_w_braid).css("height",_w_braid.height);$(this).off("mousemove").on("mousemove",_w_cast)})).on("mouseout",(function(){$(_w_braid).css("width",_w_torpor);$(_w_braid).css("height",_w_sledge);$(_w_braid).css("margin","0px auto");$(this).off("mousemove",_w_cast)}))}}