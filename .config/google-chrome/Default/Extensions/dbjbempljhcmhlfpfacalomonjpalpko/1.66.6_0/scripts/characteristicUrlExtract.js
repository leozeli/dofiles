/**
 * ImageAssistant
 * Project Home: http://www.pullywood.com/ImageAssistant/
 * Author: Joey
 * Copyright (C) 2013-2022 普利坞(Pullywood.com)
**/
"use strict";function _w_pluck(_w_nick){let _w_guru=[];for(let idx in _w_nick){let _w_pod=_w_nick[idx];if("string"!=typeof _w_pod||!_w_pod.startsWith("http"))continue;let _w_oracle=_w_pod.split(/([0-9]+)/);_w_guru.push(_w_oracle)}return _w_guru}function _w_hoop(_w_nick){let _w_guru=[];for(let idx in _w_nick){let _w_pod=_w_nick[idx];if("string"!=typeof _w_pod||!_w_pod.startsWith("http"))continue;let _w_oracle=_w_pod.split(/([^0-9a-zA-Z%]+|\d+(?=[\/_\?#]))/);let _w_shield=_w_pod.split(/([^0-9a-zA-Z%\-_]+)/);_w_guru.push(_w_oracle);if(JSON.stringify(_w_oracle)!=JSON.stringify(_w_shield)){_w_guru.push(_w_shield)}}return _w_guru}function _w_fawn(_w_hubbub,_w_lark,_w_belch){let _w_down=[...document.links];let frames=window.frames;for(let i=0;i<frames.length;++i){try{_w_down=_w_down.concat([...frames[i].document.links])}catch(e){}}let _w_nick=[];let _w_forum={};let _w_farrow=window.location.href;if(_w_farrow.indexOf("#")>0)_w_farrow=_w_farrow.substring(0,_w_farrow.indexOf("#"));for(let idx in _w_down){let _w_smear=_w_down[idx];if(_w_smear.protocol&&(_w_smear.protocol=="http:"||_w_smear.protocol=="https:")){let _w_canker=_w_smear.href.trim();if(_w_canker.indexOf("#")>0)_w_canker=_w_canker.substring(0,_w_canker.indexOf("#"));if(_w_nick.indexOf(_w_canker)<0){_w_nick.push(_w_canker);_w_forum[_w_canker]=_w_smear}else if(_w_smear.text.trim().length>_w_forum[_w_canker].text.trim().length){_w_forum[_w_canker]=_w_smear}}}if(_w_nick.indexOf(_w_farrow)<0){_w_nick.push(_w_farrow)}_w_forum[_w_farrow]=$("<a />",{href:_w_farrow,title:document.title,text:document.title})[0];let _w_guru=_w_hubbub(_w_nick);let _w_ferret={};for(let i=0;i<_w_guru.length;++i){for(let j=i+1;j<_w_guru.length;++j){let _w_medley=_w_guru[i];let _w_pony=_w_guru[j];if(_w_medley.length!=_w_pony.length)continue;let _w_tenure=0;let _w_enzyme=_w_medley.length;let _w_mural="";let _w_plague="";let _w_bigot="";let _w_fig=0;let _w_cynic=[];for(let cnt=0;cnt<_w_enzyme;++cnt){if(_w_medley[cnt]!=_w_pony[cnt]){if(_w_tenure!=0){_w_tenure=Number.MAX_SAFE_INTEGER;break}_w_plague=_w_mural;_w_mural="";_w_fig=cnt;_w_cynic.push(_w_medley[cnt]);_w_cynic.push(_w_pony[cnt]);_w_tenure++}else{_w_mural+=_w_medley[cnt]}}_w_bigot=_w_mural;_w_mural=_w_plague+"*"+_w_bigot;if(_w_tenure!=1){continue}let _w_glee=function(a,b){return a+b};let _w_cub=[_w_medley.reduce(_w_glee),_w_pony.reduce(_w_glee)];let _w_stanza=_w_ferret[_w_mural];if(_w_stanza==null){_w_stanza={};_w_stanza["joinedStrBeforeDiff"]=_w_plague;_w_stanza["joinedStrAfterDiff"]=_w_bigot;_w_stanza["joinedStrPattern"]=_w_mural;_w_stanza["diffIndex"]=_w_fig;_w_stanza["diffIsNumeric"]=true;_w_stanza["diffBreakCount"]=0;_w_stanza["diffList"]=_w_cynic;_w_stanza["urlList"]=_w_cub;_w_stanza["containCurrentPageUrl"]=false;_w_stanza["currentPageUrl"]=_w_farrow;_w_ferret[_w_mural]=_w_stanza}else{for(let idx in _w_cynic){if(_w_stanza["diffList"].indexOf(_w_cynic[idx])<0){_w_stanza["diffList"].push(_w_cynic[idx])}}for(let idx in _w_cub){if(_w_stanza["urlList"].indexOf(_w_cub[idx])<0){_w_stanza["urlList"].push(_w_cub[idx])}}}if(_w_farrow==_w_cub[0]||_w_farrow==_w_cub[1]){_w_stanza["containCurrentPageUrl"]=true}}}let _w_umpire=[];for(let pattern in _w_ferret){_w_umpire.push(_w_ferret[pattern])}for(let idx in _w_umpire){let _w_churl=_w_umpire[idx];_w_churl["diffList"].sort((function(a,b){if(jQuery.isNumeric(a)&&jQuery.isNumeric(b)){return parseInt(a)-parseInt(b)}else{return a-b}}));let _w_flint=0;let _w_skit=5;let _w_cynic=_w_churl["diffList"];for(let idx=0;idx<_w_cynic.length-1;++idx){if(idx==0&&_w_cynic[idx]==""){continue}else if(!jQuery.isNumeric(_w_cynic[idx])||!jQuery.isNumeric(_w_cynic[idx+1])){_w_flint=Number.MAX_VALUE;_w_churl["diffIsNumeric"]=false}else if(_w_cynic[idx+1]-_w_cynic[idx]>1){_w_flint+=1}}_w_churl["diffBreakCount"]=_w_flint;if(_w_flint>_w_skit){_w_churl["fillList"]=_w_churl["diffList"]}else if(_w_cynic[_w_cynic.length-1]-_w_cynic.length>1024){_w_churl["fillList"]=_w_churl["diffList"]}else{let _w_plaque=_w_cynic[0].toString()[0]=="0"&&_w_cynic[0].toString().length>1?_w_cynic[0].toString().length:1;_w_churl["fillList"]=[];for(let i=0;i<=_w_cynic[_w_cynic.length-1];++i){_w_churl["fillList"].push(_w_relish(i,_w_plaque))}}let _w_plague=_w_churl["joinedStrBeforeDiff"];let _w_bigot=_w_churl["joinedStrAfterDiff"];_w_churl["urlList"]=[];_w_churl["urlText"]={};_w_cynic=_w_churl["diffList"];for(let itemIdx in _w_cynic){let _w_armory=_w_cynic[itemIdx];let _w_pod=_w_plague+_w_armory+_w_bigot;let _w_minnow=_w_forum[_w_pod]?_w_forum[_w_pod].text:"无文字链接["+_w_armory+"]";_w_minnow=_w_minnow.trim().length>0?_w_minnow.trim():_w_pod;_w_churl["urlList"].push(_w_pod);_w_churl["urlText"][_w_pod]=_w_minnow}_w_churl["fillUrlList"]=[];_w_churl["fillUrlText"]={};let _w_enmity=_w_churl["fillList"];let _w_hawser=false;for(let itemIdx in _w_enmity){let _w_brim=_w_enmity[itemIdx];let _w_pod=_w_plague+_w_brim+_w_bigot;let _w_minnow=_w_forum[_w_pod]?_w_forum[_w_pod].text:"智能填充链接["+_w_brim+"]";_w_minnow=_w_minnow.trim().length>0?_w_minnow.trim():_w_pod;let _w_iodine=_w_plague.substr(-1);if(!_w_hawser&&(_w_iodine=="-"||_w_iodine=="_"||_w_iodine=="/")&&(_w_bigot.length==0||_w_bigot[0]==".")&&(_w_brim==0||_w_brim==1)){let _w_filter;if(_w_iodine=="/"){_w_filter=_w_plague}else{_w_filter=_w_plague.slice(0,-1)+_w_bigot}let _w_debut=_w_forum[_w_filter]?_w_forum[_w_filter].text:"智能填充链接[ ]";_w_churl["fillUrlList"].push(_w_filter);_w_churl["fillUrlText"][_w_filter]=_w_debut;_w_hawser=true;if(_w_churl["currentPageUrl"]==_w_filter){_w_churl["containCurrentPageUrl"]=true;_w_churl["urlList"].push(_w_filter);_w_churl["urlText"][_w_filter]=_w_debut}}_w_churl["fillUrlList"].push(_w_pod);_w_churl["fillUrlText"][_w_pod]=_w_minnow}}_w_umpire.sort((function(a,b){let _w_tint=0;if(a["containCurrentPageUrl"]&&!b["containCurrentPageUrl"]){_w_tint=-1}else if(!a["containCurrentPageUrl"]&&b["containCurrentPageUrl"]){_w_tint=1}if(_w_tint==0){if(a["diffIsNumeric"]&&!b["diffIsNumeric"]){_w_tint=-1}else if(!a["diffIsNumeric"]&&b["diffIsNumeric"]){_w_tint=1}}if(_w_tint==0){_w_tint=a["diffBreakCount"]-b["diffBreakCount"]}if(_w_tint==0){if(a["diffList"]&&b["diffList"]){_w_tint=b["diffList"].length-a["diffList"].length}else{_w_tint=a-b}}if(_w_tint==0&&a.diffIndex!=null&&b.diffIndex!=null){_w_tint=a.diffIndex-b.diffIndex}return _w_tint}));let _w_clip={};Object.entries(_w_forum).forEach((arr=>{_w_clip[arr[0]]=arr[1].text}));let _w_cornet=function(){chrome.runtime.sendMessage(chrome.runtime.id,{type:"_w_wax",collections:_w_umpire,links:_w_clip,currentPageUrl:_w_farrow,currentPageTitle:document.title,channel:_w_lark})};setTimeout((()=>{_w_cornet();_w_belch&&_w_leeway()}),500)}