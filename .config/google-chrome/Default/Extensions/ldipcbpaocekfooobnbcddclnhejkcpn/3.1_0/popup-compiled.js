(function(){/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/
var k=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b};class q{constructor(a){this.fa=a}}var u=new q("A"),aa=new q("BUTTON"),v=new q("DIV"),ba=new q("FORM"),ca=new q("INPUT"),da=new q("IMG"),ea=new q("TABLE"),fa=new q("TH");const w=/([?&]oi=)([^&]+)/;function x(a){return(a.match(w)||["","",""])[2]}function y(a){return a.replace(w,"$1gsb"+("gsb20">=x(a)?"00":"50"))}function z(a,b){return y(a)==y(b)}function A(a,b){a=document.createElement(a);a.className=b;return a}function C(a,b){a=document.createElement(a.fa);a.id=b;return a}function D(a,b,c=""){const d=document.createElement("a");d.setAttribute("href",a);d.textContent=b;c&&(d.className=c);return d}
function ha(a,b){const c=document.createElement("a");c.setAttribute("href",a);c.innerHTML=b;return c}function E(a,b){const c=b.length;for(let d=0;d<c;d++)a.appendChild(b[d])}function ia(a,b,c){var d=new XMLHttpRequest;d.open(b?"POST":"GET","https://scholar.google.com/"+a,!0);d.onreadystatechange=()=>{4==d.readyState&&c(d.status,d.responseText)};d.timeout=3E4;b&&d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");b?d.send(b):d.send()}
function F(a,b){let c=null;if(200==a){try{c=JSON.parse(b)}catch(d){}if("object"!=typeof c||c instanceof Array)c=null}return c};var G=class{constructor(a,b,c){this.type=a;this.link=b;this.time=c}},H=class{constructor(a,b){this.$=a;this.time=b}},J=function(a){const b=a.a.slice(a.b+1);a.a=a.a.slice(0,a.b+1);const c=a.K();var d=a.a.length-20;let e=0;for(;e<a.a.length&&36E5<c-a.a[e].time;)e+=1;d=Math.max(d,e);0<d&&(b.push(...a.a.slice(0,d)),a.a=a.a.slice(d,a.b+1),a.b=Math.max(a.b-d,-1));I(a,b);for(let f in a.A)36E5<c-a.A[f].time&&delete a.A[f]},I=function(a,b){const c={};for(var d=0;d<a.a.length;d++)c[a.a[d].link]=!0;for(d=0;d<
b.length;d++){const e=b[d].link;c[e]||(a.N["history-link-"+y(e)]=null)}},L=function(a){return a.a[a.b]||new G("home","",a.K())},M=function(a,b,c){a.N["history-link-"+y(b)]=c},ja=function(a){a.b+1<a.a.length&&(a.b+=1)},ka=function(a){0<a.b&&--a.b},N=function(a,b,c){a.A[b]=new H(c,a.K())},la=class{constructor(a=Date.now){this.a=[];this.b=-1;this.A={};this.N={};this.K=a}add(a,b){-1!=this.b&&z(this.a[this.b].link,b)||(this.b+=1,this.a[this.b]=new G(a,b,this.K()),J(this))}replace(a,b){if(!(0>this.b)){--this.b;
var c=this.a.slice(this.b+1);this.a=this.a.slice(0,this.b+1);I(this,c);this.add(a,b)}}clear(){const a=this.a;this.a=[];this.b=-1;this.A={};I(this,a)}};var ma=function(a,b){a.aa.textContent=b;b=a.aa.innerHTML;return b.replace(a.ha,(c,d)=>"<"+d+">").replace(a.ga,(c,d)=>"&"+d+";")};class na{constructor(){this.ha=/&lt;(\/?(b|i|em|br))&gt;/gi;this.ga=/&amp;([a-z0-9]+|#[0-9]+);/gi;this.aa=document.createElement("div")}};var oa=function(a){a.P.get(["authuser","history","history-index","history-patch-map"],b=>{b=b||{};a.R=b.authuser||"0";var c=a.a,d=b["history-index"],e=b["history-patch-map"];if("number"==typeof d&&Number.isInteger(d)){b=b.history;var f=[];if(Array.isArray(b))for(var h=0;h<b.length;h++){var g=b[h];"string"==typeof g.t&&"string"==typeof g.l&&"number"==typeof g.s&&f.push(new G(g.t,g.l,g.s))}b=f;c.a=b;c.b=0<=d&&d<c.a.length?d:-1;d={};if(Array.isArray(e))for(b=0;b<e.length;b++)f=e[b],"string"==typeof f.d&&
"string"==typeof f.c&&"number"==typeof f.t&&(d[f.d]=new H(f.c,f.t));e=d;c.A=e}J(c);c=document.body;c.setAttribute("dir",a.j.getMessage("@@bidi_dir"));c.innerHTML="";e=C(v,"header");d=C(aa,"search-button");d.type="submit";E(a.C,[a.Z]);E(a.W,[d,a.O,a.C]);E(e,[a.W]);b=C(v,"middle");E(b,[a.o,a.J]);f=C(v,"footer");h=C(v,"progress-inc");g=C(v,"progress-dec");E(a.ea,[h,g]);h=C(v,"footer-buttons");for(const l of[a.B,a.D])l.setAttribute("href","#"),l.setAttribute("role","button");O(a);P(a,"");a.X.setAttribute("href",
"/scholar_settings?oi=gsb&"+Q(a));a.V.setAttribute("href","/scholar?scilib=1&"+Q(a));E(h,[a.B,a.D,a.F,a.V,a.X]);E(f,[a.G,a.ea,h]);E(c,[e,b,f]);document.title=a.j.getMessage("853");d.title=a.j.getMessage("920");a.C.title=a.j.getMessage("1300");a.B.title=a.j.getMessage("1298");a.D.title=a.j.getMessage("1299");a.V.title=a.j.getMessage("732");a.F.title=a.j.getMessage("1108");a.X.title=a.j.getMessage("1301");a.W.addEventListener("submit",a.ka.bind(a));c.addEventListener("click",a.ba.bind(a));c.addEventListener("auxclick",
a.ba.bind(a));c.addEventListener("focus",a.ia.bind(a),!0);R(a,!0);void 0!==a.da&&S(a,a.da)})},O=function(a){a.B.classList.toggle("disabled",!(0<a.a.b));var b=a.a;a.D.classList.toggle("disabled",!(b.b+1<b.a.length))},P=function(a,b){b=b.replace(/([?&])(output|hl|authuser)=[^&]*/g,"$1").replace(/([?&])&+/g,"$1").replace(/&$/,"");a.F.setAttribute("href","/"+(b+(0<=b.indexOf("?")?"&":"?"))+(x(b)?"":"oi=gsb&")+(b?"lookup=0&":"")+Q(a))},Q=function(a){const b="0"==a.R?"":"&authuser="+a.R;a=a.j.getMessage("@@ui_locale");
a=pa[a]||a;return"hl="+a+b},R=function(a,b){document.body.classList.toggle("busy",b);T(a,"");U(a,"");a.J.classList.toggle("busy",b)},S=function(a,b){V(a,b);a.O.focus();P(a,"gsb20">=x(b)?"?oi=gsb00":b);W(a,b||"scholar?oi=gsb00&q=")},T=function(a,b){a.J.textContent=b},U=function(a,b,c=""){clearTimeout(a.ca);a.ca=setTimeout(()=>{a.G.innerHTML=""},3E3);a.G.innerHTML=b;a.G.className=c},X=function(a){T(a,a.j.getMessage("1107")+" ");a.J.appendChild(D(a.F.getAttribute("href"),a.j.getMessage("1108")))},ra=
function(a){var b=qa;b.R?S(b,a):b.da=a},V=function(a,b){b=sa(b);a.O.value=b},W=function(a,b){R(a,!0);b=b+(0<=b.indexOf("?")?"&":"?")+"output=gsb&"+Q(a);a.a.add("search",b);Y(a);O(a);a.H(b,"",a.T.bind(a,b))},Y=function(a){const b={},c=[];{var d=a.a;const g=d.N;var e=d.a;var f=[];for(let l=0;l<e.length;l++){const r=e[l];f.push({t:r.type,l:r.link,s:r.time})}e=f;g.history=e;g["history-index"]=d.b;e=d.A;f=[];for(h in e)f.push({d:h,c:e[h].$,t:e[h].time});var h=f;g["history-patch-map"]=h;d.N={};d=g}for(let g in d)null!=
d[g]?b[g]=d[g]:c.push(g);a.P.set(b);a.P.remove(c)},ta=function(a,b){R(a,!0);b="scholar?q=info:"+encodeURIComponent(b)+":scholar.google.com/&output=gsb-cite&"+Q(a);a.a.add("cite",b);Y(a);O(a);P(a,b);V(a,b);a.H(b,"",a.S.bind(a,b))},ua=function(a,b){return"#citations?update_op=library_add&citilm=1&xsrf="+encodeURIComponent(a.Y)+"&info="+encodeURIComponent(b)+"&user="+encodeURIComponent(a.I)+"&"+Q(a)},va=function(a,b){return"#citations?update_op=trash_citations&citilm=1&json=&xsrf="+encodeURIComponent(a.Y)+
"&s="+encodeURIComponent(a.I)+":"+encodeURIComponent(b)+"&"+Q(a)},wa=function(a,b,c){b.classList.contains("spin")||(b.classList.add("spin"),a.G.innerHTML="",a.H(c,"",a.ja.bind(a,b)))},sa=function(a){if("gsb20">=x(a)||0<a.indexOf("&output=gsb-cite"))return"";a=(a.match(/^.*[?&]q=([^&]+).*$/)||["",""])[1];return decodeURIComponent(a.replace(/[+]/g,"%20"))},Z=function(a,b){return ma(a.ma,(b||"")+"")},xa=function(a,b,c,d){const e="history-link-"+y(b);a.P.get(e,f=>{f=(f||{})[e];"string"==typeof f?c(f):
d()})};
class ya{constructor(a,b,c,d){this.j=a;this.la=b;this.H=c;this.ma=new na;this.P=d;this.F=C(u,"full-screen");this.X=C(u,"settings");this.V=C(u,"library");this.B=C(u,"back");this.D=C(u,"forward");this.C=C(u,"account");this.Z=C(da,"account-img");this.ea=C(v,"progress");this.W=C(ba,"search-form");this.O=C(ca,"search-box");this.o=C(v,"main");this.J=C(v,"message");this.G=C(v,"library-message");this.Y=this.I="";this.ca=0;this.a=new la;oa(this)}T(a,b,c,d=!1){function e(K,B){K&&(B.firstChild&&B.appendChild(document.createTextNode(" ")),B.appendChild(K))}
if(z(L(this.a).link,a)){this.o.innerHTML="";R(this,!1);var f=F(b,c)||{};b=f.r;if(b instanceof Array&&!f.L){var h=Math.min(b.length,3);this.I=(f.u||"")+"";this.Y=(f.x||"")+"";this.Z.src=(f.p||"")+""||"https://lh3.googleusercontent.com/a/default-user=s64";this.C.setAttribute("href","https://accounts.google.com/"+(this.I?"SignOutOptions":"Login")+"?continue="+encodeURIComponent("https://scholar.google.com"+this.F.getAttribute("href"))+"&"+Q(this));if(!d&&!sa(a)&&!a.match(/[?&]title=/)){if(0>=h||!f.h){this.a.replace("home",
"");O(this);Y(this);return}P(this,a)}M(this.a,L(this.a).link,c);for(a=0;a<h;a++){var g=b[a];if(!k(g))continue;var l=Z(this,g.t),r=(g.u||"")+"";const K=Z(this,g.x);var t=Z(this,g.m),n=Z(this,g.s),m=g.l||{};if(l&&k(m)){c={};for(let B in m)f=m[B],k(f)&&(c[B]=D((f.u||"")+"",(f.l||"")+"",B));f=A("div","result");var p=void 0;if(this.I&&m.f&&k(m.f)&&m.f.u&&(g=(g.c||"")+"",m=(m.f.u+"").substring(2))){if(p=this.a.A[m])d?g=p.$:N(this.a,m,g);g?(p=D(va(this,g),"","library-star"),p.classList.add("saved"),p.setAttribute("title",
this.j.getMessage("96"))):(p=D(ua(this,m),"","library-star"),p.setAttribute("title",this.j.getMessage("64")));p.setAttribute("data-docid",m)}m=A("h3","result-title");g="";K&&(g=A("span","result-marker"),g.innerHTML="["+K+"]",g=g.outerHTML+" ");l=g+l;r?(r=ha(r,l),m.appendChild(r)):m.innerHTML=l;f.appendChild(m);t&&(r=A("div","result-metadata"),r.innerHTML=t,f.appendChild(r));n&&1==h&&(t=A("div","result-snippet"),t.innerHTML=n,f.appendChild(t));n=A("div","result-links");p&&(p.innerHTML='<svg viewBox="0 0 16 16"><path d="M8 11.57l3.824 2.308-1.015-4.35 3.379-2.926-4.45-.378L8 2.122 6.261 6.224l-4.449.378 3.379 2.926-1.015 4.35z"/></svg>',
p.setAttribute("role","button"),e(p,n));if(t=c.f)t.innerHTML='<svg viewBox="0 0 16 16"><path d="M1.5 3.5v5h2v.375L1.75 12.5h3L6.5 8.875V3.5zM9.5 3.5v5h2v.375L9.75 12.5h3L14.5 8.875V3.5z"/></svg>'+t.innerHTML,t.setAttribute("role","button"),e(t,n);e(c.c,n);e(c.r,n);e(c.v,n);n.firstChild&&f.appendChild(n);n=A("div","result-access");e(c.g,n);e(c.l,n);n.firstChild&&f.appendChild(n);this.o.appendChild(f)}}this.o.firstChild||T(this,this.j.getMessage("1109"));Y(this)}else X(this)}}S(a,b,c){if(z(L(this.a).link,
a)){this.o.innerHTML="";R(this,!1);var d=F(b,c)||{};b=d.l;a=d.i||[];if(b instanceof Array&&a instanceof Array&&!d.L){d=Math.min(b.length,5);M(this.a,L(this.a).link,c);Y(this);c=C(ea,"cite");for(var e=0;e<d;e++){var f=b[e];if(!k(f))continue;var h=Z(this,f.l);f=Z(this,f.h);if(!h||!f)continue;const g=c.insertRow();g.tabIndex=0;const l=document.createElement(fa.fa);l.scope="row";l.innerHTML=h;g.appendChild(l);g.insertCell(-1).innerHTML=f}b=Math.min(a.length,5);d=C(v,"import");for(e=0;e<b;e++)h=a[e],k(h)&&
(d.firstChild&&d.appendChild(document.createTextNode(" ")),d.appendChild(D((h.u||"")+"",(h.l||"")+"")));c.firstChild?(this.o.appendChild(c),this.o.appendChild(d)):T(this,this.j.getMessage("1109"))}else X(this)}}ja(a,b,c){a.classList.remove("spin");const d=F(b,c)||{};c=a.getAttribute("data-docid")||"";const e=a.classList.contains("saved");d.L?(a=this.j.getMessage(e?"1289":"1287"),U(this,a,"error")):d.M?U(this,""+d.M,"error"):200==b&&e&&c?(a.classList.remove("saved"),a.setAttribute("href",ua(this,c)),
a.setAttribute("title",this.j.getMessage("64")),N(this.a,c,"")):Array.isArray(d.U)&&1==d.U.length&&k(d.U[0])&&!e?(a.classList.add("saved"),b=d.U[0].c.split(":")[1]||"",a.setAttribute("href",va(this,b)),a.setAttribute("title",this.j.getMessage("96")),N(this.a,c,b),U(this,this.j.getMessage("1285",['<a href="/scholar?scilib=1&'+Q(this)+'">',"</a>"]))):(a=this.j.getMessage(e?"1289":"1287"),U(this,a,"error"));Y(this)}ka(a){const b="scholar?oi=gsb95&q="+encodeURIComponent(this.O.value);P(this,b);W(this,
b);a.preventDefault()}ba(a){if(!(1<a.button)){var b=document.body;for(let c=a.target;c!=b;c=c.parentElement){const d=1==c.nodeType&&c.getAttribute("href")||"";if(c.classList.contains("disabled")){a.preventDefault();break}else if(c==this.B||c==this.D){a.preventDefault();c==this.B?ka(this.a):ja(this.a);const e=L(this.a);"home"==e.type?(this.o.innerHTML="",R(this,!1)):"search"==e.type?xa(this,e.link,f=>{this.T(e.link,200,f,!0)},()=>{R(this,!0);this.H(e.link,"",this.T.bind(this,e.link))}):"cite"==e.type&&
xa(this,e.link,f=>{this.S(e.link,200,f)},()=>{R(this,!0);this.H(e.link,"",this.S.bind(this,e.link))});P(this,e.link);V(this,e.link);O(this);Y(this);break}else if("#f"==d.substr(0,2)){a.preventDefault();ta(this,d.substr(2));break}else if("#c"==d.substr(0,2)){a.preventDefault();wa(this,c,d.substr(1));break}else if(d){a.preventDefault();c==this.C&&(this.a.clear(),Y(this));this.la(("/"==d[0]?"https://scholar.google.com":"")+d);break}}}}ia(a){a=a.target;if("TR"==a.nodeName){const b=a.querySelector("td");
b&&setTimeout(()=>{window.getSelection().selectAllChildren(b)},20)}}};class za{getMessage(a,b){return chrome.i18n.getMessage(a,b)}}var pa={en_GB:"en",en_US:"en",es_419:"es",fil:"tl",he:"iw",pt_BR:"pt-BR",pt_PT:"pt-PT",zh_CN:"zh-CN",zh_TW:"zh-TW"};class Aa{get(a,b){chrome.storage.local.get(a,c=>{b(chrome.runtime.lastError?null:c)})}set(a){chrome.storage.local.set(a,function(){})}remove(a){chrome.storage.local.remove(a)}};const qa=new ya(new za,a=>{chrome.tabs.create({url:a})},(a,b,c)=>{ia(a,b,c)},new Aa);chrome.runtime.onMessage.addListener(a=>{ra((a||"")+"")});chrome.tabs.executeScript({file:"contentscript-compiled.js"},()=>{chrome.runtime.lastError&&ra("")});}).call(this);
