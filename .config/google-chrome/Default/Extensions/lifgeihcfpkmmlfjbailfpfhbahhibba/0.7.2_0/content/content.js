(function(){"use strict";const q=typeof location<"u"&&location.search.includes("st-debug=1"),Fe=typeof location<"u"&&location.origin==="http://localhost:3000",Ct=Fe&&!(typeof chrome<"u"&&chrome?.storage),An="https://smarttoc.cc/api",$e=e=>{let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);return t},_e=(e,t,n)=>typeof n=="number"?n%(t-e+1)+e:Math.floor(Math.random()*(t-e+1))+e,pe=()=>{},En=e=>{const t=_e(0,360,$e("r"+e)),n=_e(50,100,$e("g"+e)),r=_e(60,80,$e("b"+e));return`hsl(${t}deg ${n}% ${r}%)`},he=e=>{if(!q)return pe;const t=En(e);return(...n)=>{console.info("%c"+e,`color: ${t}`,...n)}},jn=/^(R|on|off|is|get|query|has|should)/,zt=e=>{const t=Object.getPrototypeOf(e);return Object.getOwnPropertyNames(e).concat(t&&t!==Object.prototype?zt(t):[])},ke=(e,t)=>{if(!q)return e;const n=he(t),r=zt(e).filter(s=>typeof e[s]=="function");for(const s of r){if(jn.test(s))continue;const l=e[s];e[s]=function(...o){return n(s,...o),l.apply(e,o)}}return e},Ze=e=>[].slice.apply(e),Lt=e=>e===null?"null":e===void 0?"undefined":Array.isArray(e)?"array":e instanceof Date?"date":typeof e,Xe=he("equal"),le=(e,t,n)=>{if(e===t)return!0;const{ignoreEmptyKey:r=!0}=n||{},s=Lt(e),l=Lt(t);if(s!==l)return Xe("type change:",s,l),!1;if(s==="array"){const o=e.length===t.length&&e.every((u,d)=>le(u,t[d],n));return o||Xe("array length or item not equal",e,t),o}if(s==="object"){if(e instanceof Node&&t instanceof Node)return e===t;const o=Object.keys(e).sort().filter(h=>!(e[h]===void 0&&r)),u=Object.keys(t).sort().filter(h=>!(t[h]===void 0&&r)),d=o.length===u.length&&o.every((h,g)=>{const m=u[g];return h===m&&le(e[h],t[m],n)});return d||Xe("object keys not equal",e,t),d}return s==="number"?n?.numberTolerance?Math.abs(e-t)<n.numberTolerance:e===t:s==="date"?e.getTime()===t.getTime():s==="function"&&n?.ignoreFunction||e!==e&&t!==t?!0:e===t},Ke=e=>{if(!e.length)return;let[t,...n]=e;for(const r of n)if(!le(t,r))return;return t},Cn=e=>e.filter(Boolean),qe=he("dom"),Ue=new Map,V=class{static append(e,t,n){return V.withEventMuted(()=>{e.appendChild(t)},n)(),V.withEventMuted(()=>{e.contains(t)&&e.removeChild(t)},n)}static create(e,t,n){let r="",s=[],l=e.replace(/(#|\.)[^#\.]+/gi,u=>(u[0]==="#"?r=u.substr(1):s.push(u.substr(1)),""));const o=document.createElement(l||"div");return t!=null&&Object.keys(t).forEach(u=>{switch(u){case"dataset":{const d=t[u];Object.keys(d).forEach(h=>{o.dataset[h]=d[h]})}break;case"style":{const d=t[u];Object.keys(d).forEach(h=>{o.style[h]=d[h]})}break;default:o.setAttribute(u,t[u]);break}}),r&&o.setAttribute("id",r),s.length&&o.setAttribute("class",s.join(" ")),n&&(typeof n=="string"?o.innerText=String(n):n.forEach(u=>o.appendChild(u))),o}static listen(e,t,n,r){if(q||Fe){const s=(Ue.get(e)??0)+1;Ue.set(e,s)}return e.addEventListener(t,n,r),()=>{if(q||Fe){const s=(Ue.get(e)??0)-1;Ue.set(e,s)}e.removeEventListener(t,n,r)}}static addClass(e,t,n=!0){return V.withEventMuted(()=>{e.classList.add(t)},n)(),V.withEventMuted(()=>{e.classList.remove(t)},n)}static withEventMuted(e,t=!0){if(!t)return e;const n=()=>{setTimeout(function(){V.muteCount--,!V.muteCount&&q&&console.groupEnd()},16)};return(...s)=>{try{return V.muteCount++,V.muteCount===1&&q&&console.group("muted:"),e(...s)}finally{n()}}}static onResize(e,t){const{offsetWidth:n,offsetHeight:r,scrollWidth:s,scrollHeight:l}=e;let o={offsetWidth:n,offsetHeight:r,scrollWidth:s,scrollHeight:l},u=new ResizeObserver(d=>{const{offsetWidth:h,offsetHeight:g,scrollWidth:m,scrollHeight:M}=e;let N={offsetWidth:h,offsetHeight:g,scrollWidth:m,scrollHeight:M};le(o,N)||(o=N,V.muteCount===0?t(d):qe("resize event muted:",V.muteCount))});return u.observe(e),()=>{u?.disconnect(),u=void 0}}static onMutate(e,t,n){let r=new MutationObserver(s=>{V.muteCount===0?t(s):qe("mutate event muted:",V.muteCount)});return r.observe(e,n??{childList:!0,subtree:!0}),()=>{r?.disconnect(),r=void 0}}static onRemoveByPoll(e,t,n){let r;return r=setInterval(()=>{document.documentElement.contains(e)||(V.muteCount===0?t():qe("remove event muted:",V.muteCount),clearInterval(r),r=void 0)},n.delay),()=>{r!=null&&(clearInterval(r),r=void 0)}}};let S=V;S.isDocumentRtl=()=>document.dir==="rtl",S.getOverlappedRect=(e,t)=>{const n=Math.max(e.left,t.left),r=Math.min(e.right,t.right),s=Math.max(e.top,t.top),l=Math.min(e.bottom,t.bottom),o=r-n,u=l-s;if(!(o<=0||u<=0))return{left:n,right:r,top:s,bottom:l,width:o,height:u}},S.isElemVisible=e=>{if(e.offsetHeight===0||e.offsetWidth===0)return!1;const t=window.getComputedStyle(e);return!(t.display==="none"||t.opacity==="0"||t.visibility==="hidden")},S.getVisibleTextRect=e=>{const t=[...V.walkTree(e,r=>r.nodeType===Node.TEXT_NODE||r.nodeType===Node.ELEMENT_NODE&&V.isElemVisible(r)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT,NodeFilter.SHOW_ALL)],n=Cn(t.map(r=>{const s=document.createRange();return s.selectNodeContents(r),s.getClientRects()[0]})).filter(r=>r.width&&r.height);if(n.length!==0)return{top:Math.min(...n.map(r=>r.top)),left:Math.min(...n.map(r=>r.left)),bottom:Math.max(...n.map(r=>r.bottom)),right:Math.max(...n.map(r=>r.right))}},S.get=e=>typeof e=="string"?document.getElementById(e)??void 0:e,S.setStyle=(e,t,n=!0,r=!0)=>{V.withEventMuted(()=>{if(t==null){e.removeAttribute("style");return}if(typeof t=="string"){e.setAttribute("style",t);return}for(let s in t)e.style.setProperty(s.replace(/([A-Z])/g,(l,o)=>"-"+o.toLowerCase()),t[s]??null,n?"important":void 0)},r)()},S.fromPx=e=>+e.replace(/px/,""),S.toPx=e=>typeof e=="number"?e+"px":e,S.muteCount=0,S.getContainer=(e,t=document.body)=>{let n=document.getElementById(e);return n||(n=document.createElement("div"),n.id=e,t.append(n)),n},S.walkTree=function*(e,t=()=>!0,n=NodeFilter.SHOW_ELEMENT){const r=document.createTreeWalker(e,n,{acceptNode(s){const l=t(s);return typeof l=="boolean"?l?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:l}});for(;r.nextNode();)yield r.currentNode};const zn=S.create,Re=(e,t="red")=>{S.withEventMuted(()=>{!e||(Array.isArray(e)?e.forEach(n=>{n.style.outline="2px solid "+t}):e.style.outline="2px solid "+t)})()},et=e=>e===document.documentElement||e===document.body?document.scrollingElement?document.scrollingElement:document.documentElement:e,Ae=e=>et(e).scrollTop,tt=(e,t)=>{const n=et(e);n.scrollTop=t},St=e=>e===document.documentElement||e===document.body?{top:0,left:0,right:window.innerWidth,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight}:e.getBoundingClientRect(),Ln=["auto","scroll","overlay"],Ht=e=>Ln.includes(window.getComputedStyle(e).overflowY)&&e.clientHeight+1<e.scrollHeight,nt=e=>{if(e===document.documentElement)return e;for(;e&&e!==document.documentElement&&!Ht(e);)e=e.parentElement;return q&&Re(e,"purple"),et(e)},Sn=(e,t,n)=>n*e*(2-e)+t,Hn=({targetTop:e,scroller:t,spaceFromTop:n,maxDuration:r=300})=>{const s=Sn,l=t===document.documentElement||t===document.body?0:t.getBoundingClientRect().top,o=Ae(t),u=e-(l-o)-n,d=u-o,h=Math.min(1,Math.abs(d)/1e4),g=Math.max(10,r*h*(2-h));if(r===0)return tt(t,u),Promise.resolve();let m;return new Promise((M,N)=>{const w=I=>{m==null&&(m=I);const D=(I-m)/g;if(D<1){const j=s(D,o,d);tt(t,j),window.requestAnimationFrame(w)}else tt(t,u),M()};window.requestAnimationFrame(w)})},ce=(e,t,n)=>Math.max(e,Math.min(n,t));function Ee(e,t){if(!e)throw new Error(t||"assertion failed")}const Pn=e=>{throw new TypeError("Unexpected type:"+JSON.stringify(e))},Qe=(e,t,n)=>({value:e,parent:t,path:[t?.path,n].filter(r=>r!=null&&r!=="").join(".")}),Pt=({tree:e,value:t,level:n,defaultValue:r})=>{Ee(n>0,"cannot append to root level");let s=e;for(let o=0;o<n-1;o++)s.children||(s.children=[]),s.children.length===0&&s.children.push(Qe(r(s),s,s.children.length)),s=s.children[s.children.length-1];s.children||(s.children=[]);const l=Qe(t,s,s.children.length);return s.children.push(l),l};function*rt(e){if(yield e,!!e.children)for(const t of e.children)yield*rt(t)}function*Ot(e){let t=e.parent;for(;t;)yield t,t=t.parent}const kt=(e,t=-1)=>{const n=[];let r=e;for(;r&&t--;)n.push(r),r=r.parentElement;return n},On=(e,t,n)=>{if(!e.length)return;const r=new Map;e.forEach(l=>{const o=t(l);if(o!=null){const u=r.get(o)??[];u.push(l),r.set(o,u)}});let s=!1;for(const[l,o]of r.entries())o.length>=n?s=!0:r.delete(l);return s?r:void 0},kn=e=>{if(!S.isElemVisible(e))return!1;const t=window.getComputedStyle(e);if(["fixed","sticky"].includes(t.position)&&["0px","auto"].includes(t.left)&&["0px","auto"].includes(t.right)&&t.top){const r=parseInt(t.top.replace("px",""),10);if(!Number.isNaN(r)&&r<100)return!0}return!1},Zn=({elems:e,strict:t=!1,keepFirstOne:n=!1})=>{const r=[],s=(l,o)=>{for(let u=0;u<r.length;u++){const d=r[u];if(t){if(l===d[0])return u}else if(l>d[0]&&l<d[1]||o>d[0]&&o<d[1])return u}};for(const l of e){const{top:o,bottom:u}=l.getBoundingClientRect(),d=s(o,u);d==null?r.push([o,u,l]):n||r.splice(d,1)}return r.sort((l,o)=>l[0]-o[0]),r.map(l=>l[2])},ee=[0,100,60,40,30,25,22,18],Ye=[10],ie=[-500,-10],Un={h1:ee.map(e=>e*.4),[".h1"]:ee.map(e=>e*.4),h2:ee,[".h2"]:ee,h3:ee.map(e=>e*.5),[".h3"]:ee.map(e=>e*.5),h4:ee.map(e=>e*.5*.5),[".h4"]:ee.map(e=>e*.5*.5),h5:ee.map(e=>e*.5*.5*.5),[".h5"]:ee.map(e=>e*.5*.5*.5),h6:ee.map(e=>e*.5*.5*.5*.5),[".h6"]:ee.map(e=>e*.5*.5*.5*.5),strong:ee.map(e=>e*.5*.5*.5),b:ee.map(e=>e*.5*.5*.5),article:Ye,["[class^=article]"]:Ye,["[id^=article]"]:Ye,["[class^=content]"]:Ye,sidebar:ie,["[class^=sidebar]"]:ie,["[id^=sidebar]"]:ie,aside:ie,["[class^=aside]"]:ie,["[id^=aside]"]:ie,nav:ie,["[class^=nav]"]:ie,["[class^=navigation]"]:ie,["[class^=toc]"]:ie,["[class^=table-of-contents]"]:ie,["[class^=comment]"]:ie},Zt={h1:4,[".h1"]:4,h2:9,[".h2"]:9,h3:9,[".h3"]:9,h4:10,[".h4"]:10,h5:10,[".h5"]:10,h6:10,[".h6"]:10,strong:5,b:5},Ut=e=>!(e.toLowerCase()==="strong"||e.toLowerCase()==="b"),Rt=e=>{if(!e)return[];let t=[];try{t=Ze(e.document.getElementsByTagName("iframe"))}catch{}const n=[];return t.forEach(r=>{n.push(r,...Rt(r.contentWindow))}),n},it=he("extractor"),Rn=e=>{const t=o=>{let u="";for(let m of S.walkTree(o,M=>M.nodeType===Node.ELEMENT_NODE&&!S.isElemVisible(M)?NodeFilter.FILTER_REJECT:(M.nodeType===Node.TEXT_NODE&&(u+=M.textContent),NodeFilter.FILTER_ACCEPT),NodeFilter.SHOW_ALL));const d=o.id||o.querySelector("[id]")?.id;let h=d?"#"+d:void 0;const g=o.querySelector("a");if(g){h=h??g.getAttribute("href")??"";const m=g.textContent;return{text:u,anchor:h,aText:m}}return{text:u,anchor:h,aText:void 0}},n=e.map(o=>{const{dom:u}=o,{text:d,anchor:h,aText:g}=t(u),m=g&&d.includes(g)?d.indexOf(g):-1,M=g&&d.includes(g)?d.length-d.lastIndexOf(g):-1;return{...o,text:d,anchor:h,aText:g,aFromStart:m,aTilEnd:M}}),r=Ke(n.map(o=>o.aText)),s=Ke(n.map(o=>o.aFromStart))??-1,l=Ke(n.map(o=>o.aTilEnd))??-1;return r&&(s!==-1?n.forEach(o=>{o.text=o.text.substring(0,s)+o.text.substring(s+r.length)}):l!==-1&&n.forEach(o=>{o.text=o.text.substring(0,o.text.length-l)+o.text.substring(o.text.length-l+r.length)})),n.map(o=>{const{aText:u,aFromStart:d,aTilEnd:h,...g}=o;return g})},je=class{static extractHeadingGroups(e,t){const s=S.isDocumentRtl();if(t)return t.map((h,g)=>{const m=Ze(e.querySelectorAll(h));return{selector:h,selectorIndex:g,elems:m,boundary:-1}}).filter(h=>h.elems.length>0);const l=[];return Object.keys(Zt).forEach((h,g)=>{let m=Ze(e.querySelectorAll(h));const M=Zn({elems:m,strict:!0,keepFirstOne:!1}),N=On(M,I=>{if(Ut(I.tagName)){const{display:j}=window.getComputedStyle(I);if(j==="inline"||j==="inline-block")return-1}else if(I.parentElement?.childNodes.length!==1)return-1;const D=I.getBoundingClientRect();return s?D.right:D.left},3),w=N?[...N.keys()]:[-1];for(const I of w){if(!Ut(h)&&I===-1)continue;const D=I===-1?M:N.get(I),j=Zt[h];!D.length||l.push({selector:h,selectorIndex:g,boundary:I,elems:D,score:D.length*j})}return l}),l.filter(h=>h.score>=10&&h.elems.length>0).sort((h,g)=>{if(h.boundary!==-1&&g.boundary!==-1){const m=s?g.boundary-h.boundary:h.boundary-g.boundary;if(m)return m}return h.selectorIndex!==g.selectorIndex?h.selectorIndex-g.selectorIndex:0}).slice(0,20)}static getSortedHeadings(e,t){const n=new Map;t.forEach((l,o)=>l.elems.forEach(u=>n.set(u,o)));const r=[];let s=0;for(const l of S.walkTree(e,o=>n.has(o))){const o=l,u=n.get(o),d={dom:o,level:u,index:s};r.push(d),s++}return r}};let ue=je;ue.detectMainWindow=()=>{const e=window.top||window,t=Rt(e);if(t.length===0)return e;const r=t.map(o=>({iframe:o,area:o.offsetWidth*o.offsetHeight})).sort((o,u)=>u.area-o.area)[0],s=e.document.documentElement,l=s.offsetWidth*s.offsetHeight;return r.area>l*.5&&r.iframe.contentWindow||e},ue.extractContent=({headingSelectors:e}={})=>{const t=je.extractArticle({headingSelectors:e});if(!t)return;const n=je.extractHeadings({articleDom:t,headingSelectors:e}),r=n.headings;if(e=e??n.headingSelectors,!r||!r.length)return;const s=nt(t),l=Math.max(...r.map(o=>o.level))+1;return{article:t,headings:r,maxLevel:l,headingSelectors:e,scroller:s}},ue.extractHeadings=({articleDom:e,headingSelectors:t})=>{const n=je.extractHeadingGroups(e,t),r=je.getSortedHeadings(e,n),s=Rn(r);return(o=>{const u=Qe(void 0);o.forEach(h=>{Pt({tree:u,value:h,level:h.level+1,defaultValue:g=>{}})});const d=(h,g)=>{h.value&&(h.value.level=g,g+=1);const m=h.children;!m||m.forEach(M=>{d(M,g)})};d(u,0)})(s),q&&(n.forEach((o,u)=>{Re(o.elems,["hsl(0deg 100% 50% / 100%)","hsl(0deg 100% 50% / 80%)","hsl(0deg 100% 50% / 60%)","hsl(0deg 100% 50% / 40%)","hsl(0deg 100% 50% / 20%)"][u])}),it("extractHeadings",{headingGroups:n,headings:r})),{headings:s,headingSelectors:n.map(o=>o.selector)}},ue.extractArticle=({headingSelectors:e})=>{const t=new Map,n=e?Object.fromEntries(e.map((g,m)=>[g,[0,100,60,40,30,25,22,18].map(M=>M*Math.pow(.5,m))])):Un;Object.keys(n).forEach(g=>{Ze(document.querySelectorAll(g)).forEach(M=>{const N=n[g];kt(M,N.length).forEach((I,D)=>{const j=t.get(I)??0,H=N[D]??0;t.set(I,j+H)})})});const r=[...t].map(([g,m])=>({elem:g,score:m})).sort((g,m)=>m.score-g.score),{innerWidth:s}=window,l=g=>{let{left:m,top:M,bottom:N,right:w}=St(g);const I=nt(g),D=Ae(I);M-=D,N-=D;const j=s/2;let H=1;return(m>j||w<j)&&(H-=.5),M>400&&(H-=(M-400)/1e3),ce(0,H,1)},o=[],u=5;for(const{elem:g,score:m}of r){const M=g.scrollHeight,N=g.scrollWidth,w=ce(0,g.querySelectorAll("a").length/((M||1)/20),1),I=l(g);if(!I)continue;const D=N<400?0:1;if(!D)continue;const j=ce(0,Math.sqrt(M)/100,1);if(!j)continue;const H=Ht(g)&&g!==document.documentElement?0:1;if(!H)continue;const P=ce(.2,Math.pow(1-w,2),1);if(!P)continue;const E={width:D,height:j,position:I,widthFromChildren:1,scroll:H,linkDensity:P};if(o.push({elem:g,score:m,factors:E}),o.length>=u)break}o.forEach(g=>{o.forEach(m=>{m.elem.contains(g.elem)&&(m.factors.widthFromChildren*=g.factors.width)})});const d=o.map(g=>{const m=g.factors,M=g.score*m.height*m.width*m.position*m.linkDensity*m.scroll*m.widthFromChildren;return{...g,finalScore:M}});d.sort((g,m)=>m.finalScore-g.finalScore);const h=d[0]?.elem;return q&&(it("extractArticle",{scores:t,candidatesAll:r,finalCandidates:d}),Re(h,"red")),h},ue.detectHeaderHeight=({watcher:e})=>{const{measurements:t}=e;if(!t)return;const{scrollerRect:n}=t,r=window.innerWidth/2,s=o=>{const u=[{x:r,y:o}];for(const d of u){const h=document.elementFromPoint(d.x,d.y);if(!h)continue;const m=kt(h).reverse().find(P=>kn(P));if(!m)continue;let{left:M,top:N,bottom:w,right:I,height:D,width:j}=m.getBoundingClientRect();D+=N,N=0;const H=S.getOverlappedRect({left:M,top:N,bottom:w,right:I,height:D,width:j},n);if(!!H)return it("detected header:",m,H),q&&Re(m,"lightgreen"),H.height}};return s(60)||s(5)||0};var Ie=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Me(e,t,n,r,s,l){return{tag:e,key:t,attrs:n,children:r,text:s,dom:l,domSize:void 0,state:void 0,events:void 0,instance:void 0}}Me.normalize=function(e){return Array.isArray(e)?Me("[",void 0,void 0,Me.normalizeChildren(e),void 0,void 0):e==null||typeof e=="boolean"?null:typeof e=="object"?e:Me("#",void 0,void 0,String(e),void 0,void 0)},Me.normalizeChildren=function(e){var t=[];if(e.length){for(var n=e[0]!=null&&e[0].key!=null,r=1;r<e.length;r++)if((e[r]!=null&&e[r].key!=null)!==n)throw new TypeError(n&&(e[r]!=null||typeof e[r]=="boolean")?"In fragments, vnodes must either all have keys or none have keys. You may wish to consider using an explicit keyed empty fragment, m.fragment({key: ...}), instead of a hole.":"In fragments, vnodes must either all have keys or none have keys.");for(var r=0;r<e.length;r++)t[r]=Me.normalize(e[r])}return t};var ge=Me,Qn=ge,Qt=function(){var e=arguments[this],t=this+1,n;if(e==null?e={}:(typeof e!="object"||e.tag!=null||Array.isArray(e))&&(e={},t=this),arguments.length===t+1)n=arguments[t],Array.isArray(n)||(n=[n]);else for(n=[];t<arguments.length;)n.push(arguments[t++]);return Qn("",e.key,e,n)},We={}.hasOwnProperty,Yn=ge,Wn=Qt,Ne=We,Bn=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,Yt={};function Wt(e){for(var t in e)if(Ne.call(e,t))return!1;return!0}function Gn(e){for(var t,n="div",r=[],s={};t=Bn.exec(e);){var l=t[1],o=t[2];if(l===""&&o!=="")n=o;else if(l==="#")s.id=o;else if(l===".")r.push(o);else if(t[3][0]==="["){var u=t[6];u&&(u=u.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),t[4]==="class"?r.push(u):s[t[4]]=u===""?u:u||!0}}return r.length>0&&(s.className=r.join(" ")),Yt[e]={tag:n,attrs:s}}function Vn(e,t){var n=t.attrs,r=Ne.call(n,"class"),s=r?n.class:n.className;if(t.tag=e.tag,t.attrs={},!Wt(e.attrs)&&!Wt(n)){var l={};for(var o in n)Ne.call(n,o)&&(l[o]=n[o]);n=l}for(var o in e.attrs)Ne.call(e.attrs,o)&&o!=="className"&&!Ne.call(n,o)&&(n[o]=e.attrs[o]);(s!=null||e.attrs.className!=null)&&(n.className=s!=null?e.attrs.className!=null?String(e.attrs.className)+" "+String(s):s:e.attrs.className!=null?e.attrs.className:null),r&&(n.class=null);for(var o in n)if(Ne.call(n,o)&&o!=="key"){t.attrs=n;break}return t}function Jn(e){if(e==null||typeof e!="string"&&typeof e!="function"&&typeof e.view!="function")throw Error("The selector must be either a string or a component.");var t=Wn.apply(1,arguments);return typeof e=="string"&&(t.children=Yn.normalizeChildren(t.children),e!=="[")?Vn(Yt[e]||Gn(e),t):(t.tag=e,t)}var Bt=Jn,Fn=ge,$n=function(e){return e==null&&(e=""),Fn("<",void 0,void 0,e,void 0,void 0)},_n=ge,Xn=Qt,Kn=function(){var e=Xn.apply(0,arguments);return e.tag="[",e.children=_n.normalizeChildren(e.children),e},at=Bt;at.trust=$n,at.fragment=Kn;var qn=at,Ce={exports:{}},J=function(e){if(!(this instanceof J))throw new Error("Promise must be called with 'new'.");if(typeof e!="function")throw new TypeError("executor must be a function.");var t=this,n=[],r=[],s=d(n,!0),l=d(r,!1),o=t._instance={resolvers:n,rejectors:r},u=typeof setImmediate=="function"?setImmediate:setTimeout;function d(g,m){return function M(N){var w;try{if(m&&N!=null&&(typeof N=="object"||typeof N=="function")&&typeof(w=N.then)=="function"){if(N===t)throw new TypeError("Promise can't be resolved with itself.");h(w.bind(N))}else u(function(){!m&&g.length===0&&console.error("Possible unhandled promise rejection:",N);for(var I=0;I<g.length;I++)g[I](N);n.length=0,r.length=0,o.state=m,o.retry=function(){M(N)}})}catch(I){l(I)}}}function h(g){var m=0;function M(w){return function(I){m++>0||w(I)}}var N=M(l);try{g(M(s),N)}catch(w){N(w)}}h(e)};J.prototype.then=function(e,t){var n=this,r=n._instance;function s(d,h,g,m){h.push(function(M){if(typeof d!="function")g(M);else try{l(d(M))}catch(N){o&&o(N)}}),typeof r.retry=="function"&&m===r.state&&r.retry()}var l,o,u=new J(function(d,h){l=d,o=h});return s(e,r.resolvers,l,!0),s(t,r.rejectors,o,!1),u},J.prototype.catch=function(e){return this.then(null,e)},J.prototype.finally=function(e){return this.then(function(t){return J.resolve(e()).then(function(){return t})},function(t){return J.resolve(e()).then(function(){return J.reject(t)})})},J.resolve=function(e){return e instanceof J?e:new J(function(t){t(e)})},J.reject=function(e){return new J(function(t,n){n(e)})},J.all=function(e){return new J(function(t,n){var r=e.length,s=0,l=[];if(e.length===0)t([]);else for(var o=0;o<e.length;o++)(function(u){function d(h){s++,l[u]=h,s===r&&t(l)}e[u]!=null&&(typeof e[u]=="object"||typeof e[u]=="function")&&typeof e[u].then=="function"?e[u].then(d,n):d(e[u])})(o)})},J.race=function(e){return new J(function(t,n){for(var r=0;r<e.length;r++)e[r].then(t,n)})};var Gt=J,ze=Gt;typeof window<"u"?(typeof window.Promise>"u"?window.Promise=ze:window.Promise.prototype.finally||(window.Promise.prototype.finally=ze.prototype.finally),Ce.exports=window.Promise):typeof Ie<"u"?(typeof Ie.Promise>"u"?Ie.Promise=ze:Ie.Promise.prototype.finally||(Ie.Promise.prototype.finally=ze.prototype.finally),Ce.exports=Ie.Promise):Ce.exports=ze;var ot=ge,er=function(e){var t=e&&e.document,n,r={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function s(a){return a.attrs&&a.attrs.xmlns||r[a.tag]}function l(a,i){if(a.state!==i)throw new Error("'vnode.state' must not be modified.")}function o(a){var i=a.state;try{return this.apply(i,arguments)}finally{l(a,i)}}function u(){try{return t.activeElement}catch{return null}}function d(a,i,c,f,p,y,C){for(var O=c;O<f;O++){var v=i[O];v!=null&&h(a,v,p,C,y)}}function h(a,i,c,f,p){var y=i.tag;if(typeof y=="string")switch(i.state={},i.attrs!=null&&xt(i.attrs,i,c),y){case"#":g(a,i,p);break;case"<":M(a,i,f,p);break;case"[":N(a,i,c,f,p);break;default:w(a,i,c,f,p)}else D(a,i,c,f,p)}function g(a,i,c){i.dom=t.createTextNode(i.children),L(a,i.dom,c)}var m={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function M(a,i,c,f){var p=i.children.match(/^\s*?<(\w+)/im)||[],y=t.createElement(m[p[1]]||"div");c==="http://www.w3.org/2000/svg"?(y.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+i.children+"</svg>",y=y.firstChild):y.innerHTML=i.children,i.dom=y.firstChild,i.domSize=y.childNodes.length,i.instance=[];for(var C=t.createDocumentFragment(),O;O=y.firstChild;)i.instance.push(O),C.appendChild(O);L(a,C,f)}function N(a,i,c,f,p){var y=t.createDocumentFragment();if(i.children!=null){var C=i.children;d(y,C,0,C.length,c,null,f)}i.dom=y.firstChild,i.domSize=y.childNodes.length,L(a,y,p)}function w(a,i,c,f,p){var y=i.tag,C=i.attrs,O=C&&C.is;f=s(i)||f;var v=f?O?t.createElementNS(f,y,{is:O}):t.createElementNS(f,y):O?t.createElement(y,{is:O}):t.createElement(y);if(i.dom=v,C!=null&&He(i,C,f),L(a,v,p),!G(i)&&i.children!=null){var Z=i.children;d(v,Z,0,Z.length,c,null,f),i.tag==="select"&&C!=null&&ai(i,C)}}function I(a,i){var c;if(typeof a.tag.view=="function"){if(a.state=Object.create(a.tag),c=a.state.view,c.$$reentrantLock$$!=null)return;c.$$reentrantLock$$=!0}else{if(a.state=void 0,c=a.tag,c.$$reentrantLock$$!=null)return;c.$$reentrantLock$$=!0,a.state=a.tag.prototype!=null&&typeof a.tag.prototype.view=="function"?new a.tag(a):a.tag(a)}if(xt(a.state,a,i),a.attrs!=null&&xt(a.attrs,a,i),a.instance=ot.normalize(o.call(a.state.view,a)),a.instance===a)throw Error("A view cannot return the vnode it received as argument");c.$$reentrantLock$$=null}function D(a,i,c,f,p){I(i,c),i.instance!=null?(h(a,i.instance,c,f,p),i.dom=i.instance.dom,i.domSize=i.dom!=null?i.instance.domSize:0):i.domSize=0}function j(a,i,c,f,p,y){if(!(i===c||i==null&&c==null))if(i==null||i.length===0)d(a,c,0,c.length,f,p,y);else if(c==null||c.length===0)oe(a,i,0,i.length);else{var C=i[0]!=null&&i[0].key!=null,O=c[0]!=null&&c[0].key!=null,v=0,Z=0;if(!C)for(;Z<i.length&&i[Z]==null;)Z++;if(!O)for(;v<c.length&&c[v]==null;)v++;if(C!==O)oe(a,i,Z,i.length),d(a,c,v,c.length,f,p,y);else if(O){for(var X=i.length-1,$=c.length-1,Je,K,B,_,R,vt;X>=Z&&$>=v&&(_=i[X],R=c[$],_.key===R.key);)_!==R&&H(a,_,R,f,p,y),R.dom!=null&&(p=R.dom),X--,$--;for(;X>=Z&&$>=v&&(K=i[Z],B=c[v],K.key===B.key);)Z++,v++,K!==B&&H(a,K,B,f,Y(i,Z,p),y);for(;X>=Z&&$>=v&&!(v===$||K.key!==R.key||_.key!==B.key);)vt=Y(i,Z,p),te(a,_,vt),_!==B&&H(a,_,B,f,vt,y),++v<=--$&&te(a,K,p),K!==R&&H(a,K,R,f,p,y),R.dom!=null&&(p=R.dom),Z++,X--,_=i[X],R=c[$],K=i[Z],B=c[v];for(;X>=Z&&$>=v&&_.key===R.key;)_!==R&&H(a,_,R,f,p,y),R.dom!=null&&(p=R.dom),X--,$--,_=i[X],R=c[$];if(v>$)oe(a,i,Z,X+1);else if(Z>X)d(a,c,v,$+1,f,p,y);else{var di=p,Tn=$-v+1,Oe=new Array(Tn),Tt=0,W=0,At=2147483647,Et=0,Je,jt;for(W=0;W<Tn;W++)Oe[W]=-1;for(W=$;W>=v;W--){Je==null&&(Je=T(i,Z,X+1)),R=c[W];var Te=Je[R.key];Te!=null&&(At=Te<At?Te:-1,Oe[W-v]=Te,_=i[Te],i[Te]=null,_!==R&&H(a,_,R,f,p,y),R.dom!=null&&(p=R.dom),Et++)}if(p=di,Et!==X-Z+1&&oe(a,i,Z,X+1),Et===0)d(a,c,v,$+1,f,p,y);else if(At===-1)for(jt=Q(Oe),Tt=jt.length-1,W=$;W>=v;W--)B=c[W],Oe[W-v]===-1?h(a,B,f,y,p):jt[Tt]===W-v?Tt--:te(a,B,p),B.dom!=null&&(p=c[W].dom);else for(W=$;W>=v;W--)B=c[W],Oe[W-v]===-1&&h(a,B,f,y,p),B.dom!=null&&(p=c[W].dom)}}else{var Dt=i.length<c.length?i.length:c.length;for(v=v<Z?v:Z;v<Dt;v++)K=i[v],B=c[v],!(K===B||K==null&&B==null)&&(K==null?h(a,B,f,y,Y(i,v+1,p)):B==null?se(a,K):H(a,K,B,f,Y(i,v+1,p),y));i.length>Dt&&oe(a,i,v,i.length),c.length>Dt&&d(a,c,v,c.length,f,p,y)}}}function H(a,i,c,f,p,y){var C=i.tag,O=c.tag;if(C===O){if(c.state=i.state,c.events=i.events,ui(c,i))return;if(typeof C=="string")switch(c.attrs!=null&&wt(c.attrs,c,f),C){case"#":P(i,c);break;case"<":E(a,i,c,y,p);break;case"[":k(a,i,c,f,p,y);break;default:b(i,c,f,y)}else z(a,i,c,f,p,y)}else se(a,i),h(a,c,f,y,p)}function P(a,i){a.children.toString()!==i.children.toString()&&(a.dom.nodeValue=i.children),i.dom=a.dom}function E(a,i,c,f,p){i.children!==c.children?(re(a,i),M(a,c,f,p)):(c.dom=i.dom,c.domSize=i.domSize,c.instance=i.instance)}function k(a,i,c,f,p,y){j(a,i.children,c.children,f,p,y);var C=0,O=c.children;if(c.dom=null,O!=null){for(var v=0;v<O.length;v++){var Z=O[v];Z!=null&&Z.dom!=null&&(c.dom==null&&(c.dom=Z.dom),C+=Z.domSize||1)}C!==1&&(c.domSize=C)}}function b(a,i,c,f){var p=i.dom=a.dom;f=s(i)||f,i.tag==="textarea"&&i.attrs==null&&(i.attrs={}),oi(i,a.attrs,i.attrs,f),G(i)||j(p,a.children,i.children,c,null,f)}function z(a,i,c,f,p,y){if(c.instance=ot.normalize(o.call(c.state.view,c)),c.instance===c)throw Error("A view cannot return the vnode it received as argument");wt(c.state,c,f),c.attrs!=null&&wt(c.attrs,c,f),c.instance!=null?(i.instance==null?h(a,c.instance,f,y,p):H(a,i.instance,c.instance,f,p,y),c.dom=c.instance.dom,c.domSize=c.instance.domSize):i.instance!=null?(se(a,i.instance),c.dom=void 0,c.domSize=0):(c.dom=i.dom,c.domSize=i.domSize)}function T(a,i,c){for(var f=Object.create(null);i<c;i++){var p=a[i];if(p!=null){var y=p.key;y!=null&&(f[y]=i)}}return f}var A=[];function Q(a){for(var i=[0],c=0,f=0,p=0,y=A.length=a.length,p=0;p<y;p++)A[p]=a[p];for(var p=0;p<y;++p)if(a[p]!==-1){var C=i[i.length-1];if(a[C]<a[p]){A[p]=C,i.push(p);continue}for(c=0,f=i.length-1;c<f;){var O=(c>>>1)+(f>>>1)+(c&f&1);a[i[O]]<a[p]?c=O+1:f=O}a[p]<a[i[c]]&&(c>0&&(A[p]=i[c-1]),i[c]=p)}for(c=i.length,f=i[c-1];c-- >0;)i[c]=f,f=A[f];return A.length=0,i}function Y(a,i,c){for(;i<a.length;i++)if(a[i]!=null&&a[i].dom!=null)return a[i].dom;return c}function te(a,i,c){var f=t.createDocumentFragment();ne(a,f,i),L(a,f,c)}function ne(a,i,c){for(;c.dom!=null&&c.dom.parentNode===a;){if(typeof c.tag!="string"){if(c=c.instance,c!=null)continue}else if(c.tag==="<")for(var f=0;f<c.instance.length;f++)i.appendChild(c.instance[f]);else if(c.tag!=="[")i.appendChild(c.dom);else if(c.children.length===1){if(c=c.children[0],c!=null)continue}else for(var f=0;f<c.children.length;f++){var p=c.children[f];p!=null&&ne(a,i,p)}break}}function L(a,i,c){c!=null?a.insertBefore(i,c):a.appendChild(i)}function G(a){if(a.attrs==null||a.attrs.contenteditable==null&&a.attrs.contentEditable==null)return!1;var i=a.children;if(i!=null&&i.length===1&&i[0].tag==="<"){var c=i[0].children;a.dom.innerHTML!==c&&(a.dom.innerHTML=c)}else if(i!=null&&i.length!==0)throw new Error("Child node of a contenteditable must be trusted.");return!0}function oe(a,i,c,f){for(var p=c;p<f;p++){var y=i[p];y!=null&&se(a,y)}}function se(a,i){var c=0,f=i.state,p,y;if(typeof i.tag!="string"&&typeof i.state.onbeforeremove=="function"){var C=o.call(i.state.onbeforeremove,i);C!=null&&typeof C.then=="function"&&(c=1,p=C)}if(i.attrs&&typeof i.attrs.onbeforeremove=="function"){var C=o.call(i.attrs.onbeforeremove,i);C!=null&&typeof C.then=="function"&&(c|=2,y=C)}if(l(i,f),!c)me(i),Se(a,i);else{if(p!=null){var O=function(){c&1&&(c&=2,c||v())};p.then(O,O)}if(y!=null){var O=function(){c&2&&(c&=1,c||v())};y.then(O,O)}}function v(){l(i,f),me(i),Se(a,i)}}function re(a,i){for(var c=0;c<i.instance.length;c++)a.removeChild(i.instance[c])}function Se(a,i){for(;i.dom!=null&&i.dom.parentNode===a;){if(typeof i.tag!="string"){if(i=i.instance,i!=null)continue}else if(i.tag==="<")re(a,i);else{if(i.tag!=="["&&(a.removeChild(i.dom),!Array.isArray(i.children)))break;if(i.children.length===1){if(i=i.children[0],i!=null)continue}else for(var c=0;c<i.children.length;c++){var f=i.children[c];f!=null&&Se(a,f)}}break}}function me(a){if(typeof a.tag!="string"&&typeof a.state.onremove=="function"&&o.call(a.state.onremove,a),a.attrs&&typeof a.attrs.onremove=="function"&&o.call(a.attrs.onremove,a),typeof a.tag!="string")a.instance!=null&&me(a.instance);else{var i=a.children;if(Array.isArray(i))for(var c=0;c<i.length;c++){var f=i[c];f!=null&&me(f)}}}function He(a,i,c){a.tag==="input"&&i.type!=null&&a.dom.setAttribute("type",i.type);var f=i!=null&&a.tag==="input"&&i.type==="file";for(var p in i)yt(a,p,null,i[p],c,f)}function yt(a,i,c,f,p,y){if(!(i==="key"||i==="is"||f==null||xn(i)||c===f&&!si(a,i)&&typeof f!="object"||i==="type"&&a.tag==="input")){if(i[0]==="o"&&i[1]==="n")return vn(a,i,f);if(i.slice(0,6)==="xlink:")a.dom.setAttributeNS("http://www.w3.org/1999/xlink",i.slice(6),f);else if(i==="style")Dn(a.dom,c,f);else if(wn(a,i,p)){if(i==="value"){if((a.tag==="input"||a.tag==="textarea")&&a.dom.value===""+f&&(y||a.dom===u())||a.tag==="select"&&c!==null&&a.dom.value===""+f||a.tag==="option"&&c!==null&&a.dom.value===""+f)return;if(y&&""+f!=""){console.error("`value` is read-only on file inputs!");return}}a.dom[i]=f}else typeof f=="boolean"?f?a.dom.setAttribute(i,""):a.dom.removeAttribute(i):a.dom.setAttribute(i==="className"?"class":i,f)}}function ii(a,i,c,f){if(!(i==="key"||i==="is"||c==null||xn(i)))if(i[0]==="o"&&i[1]==="n")vn(a,i,void 0);else if(i==="style")Dn(a.dom,c,null);else if(wn(a,i,f)&&i!=="className"&&i!=="title"&&!(i==="value"&&(a.tag==="option"||a.tag==="select"&&a.dom.selectedIndex===-1&&a.dom===u()))&&!(a.tag==="input"&&i==="type"))a.dom[i]=null;else{var p=i.indexOf(":");p!==-1&&(i=i.slice(p+1)),c!==!1&&a.dom.removeAttribute(i==="className"?"class":i)}}function ai(a,i){if("value"in i)if(i.value===null)a.dom.selectedIndex!==-1&&(a.dom.value=null);else{var c=""+i.value;(a.dom.value!==c||a.dom.selectedIndex===-1)&&(a.dom.value=c)}"selectedIndex"in i&&yt(a,"selectedIndex",null,i.selectedIndex,void 0)}function oi(a,i,c,f){if(i&&i===c&&console.warn("Don't reuse attrs object, use new object for every redraw, this will throw in next major"),c!=null){a.tag==="input"&&c.type!=null&&a.dom.setAttribute("type",c.type);var p=a.tag==="input"&&c.type==="file";for(var y in c)yt(a,y,i&&i[y],c[y],f,p)}var C;if(i!=null)for(var y in i)(C=i[y])!=null&&(c==null||c[y]==null)&&ii(a,y,C,f)}function si(a,i){return i==="value"||i==="checked"||i==="selectedIndex"||i==="selected"&&a.dom===u()||a.tag==="option"&&a.dom.parentNode===t.activeElement}function xn(a){return a==="oninit"||a==="oncreate"||a==="onupdate"||a==="onremove"||a==="onbeforeremove"||a==="onbeforeupdate"}function wn(a,i,c){return c===void 0&&(a.tag.indexOf("-")>-1||a.attrs!=null&&a.attrs.is||i!=="href"&&i!=="list"&&i!=="form"&&i!=="width"&&i!=="height")&&i in a.dom}var ci=/[A-Z]/g;function li(a){return"-"+a.toLowerCase()}function It(a){return a[0]==="-"&&a[1]==="-"?a:a==="cssFloat"?"float":a.replace(ci,li)}function Dn(a,i,c){if(i!==c)if(c==null)a.style.cssText="";else if(typeof c!="object")a.style.cssText=c;else if(i==null||typeof i!="object"){a.style.cssText="";for(var f in c){var p=c[f];p!=null&&a.style.setProperty(It(f),String(p))}}else{for(var f in c){var p=c[f];p!=null&&(p=String(p))!==String(i[f])&&a.style.setProperty(It(f),p)}for(var f in i)i[f]!=null&&c[f]==null&&a.style.removeProperty(It(f))}}function Nt(){this._=n}Nt.prototype=Object.create(null),Nt.prototype.handleEvent=function(a){var i=this["on"+a.type],c;typeof i=="function"?c=i.call(a.currentTarget,a):typeof i.handleEvent=="function"&&i.handleEvent(a),this._&&a.redraw!==!1&&(0,this._)(),c===!1&&(a.preventDefault(),a.stopPropagation())};function vn(a,i,c){if(a.events!=null){if(a.events._=n,a.events[i]===c)return;c!=null&&(typeof c=="function"||typeof c=="object")?(a.events[i]==null&&a.dom.addEventListener(i.slice(2),a.events,!1),a.events[i]=c):(a.events[i]!=null&&a.dom.removeEventListener(i.slice(2),a.events,!1),a.events[i]=void 0)}else c!=null&&(typeof c=="function"||typeof c=="object")&&(a.events=new Nt,a.dom.addEventListener(i.slice(2),a.events,!1),a.events[i]=c)}function xt(a,i,c){typeof a.oninit=="function"&&o.call(a.oninit,i),typeof a.oncreate=="function"&&c.push(o.bind(a.oncreate,i))}function wt(a,i,c){typeof a.onupdate=="function"&&c.push(o.bind(a.onupdate,i))}function ui(a,i){do{if(a.attrs!=null&&typeof a.attrs.onbeforeupdate=="function"){var c=o.call(a.attrs.onbeforeupdate,a,i);if(c!==void 0&&!c)break}if(typeof a.tag!="string"&&typeof a.state.onbeforeupdate=="function"){var c=o.call(a.state.onbeforeupdate,a,i);if(c!==void 0&&!c)break}return!1}while(!1);return a.dom=i.dom,a.domSize=i.domSize,a.instance=i.instance,a.attrs=i.attrs,a.children=i.children,a.text=i.text,!0}var Pe;return function(a,i,c){if(!a)throw new TypeError("DOM element being rendered to does not exist.");if(Pe!=null&&a.contains(Pe))throw new TypeError("Node is currently being rendered to and thus is locked.");var f=n,p=Pe,y=[],C=u(),O=a.namespaceURI;Pe=a,n=typeof c=="function"?c:void 0;try{a.vnodes==null&&(a.textContent=""),i=ot.normalizeChildren(Array.isArray(i)?i:[i]),j(a,a.vnodes,i,y,null,O==="http://www.w3.org/1999/xhtml"?void 0:O),a.vnodes=i,C!=null&&u()!==C&&typeof C.focus=="function"&&C.focus();for(var v=0;v<y.length;v++)y[v]()}finally{n=f,Pe=p}}},Vt=er(typeof window<"u"?window:null),Jt=ge,tr=function(e,t,n){var r=[],s=!1,l=-1;function o(){for(l=0;l<r.length;l+=2)try{e(r[l],Jt(r[l+1]),u)}catch(h){n.error(h)}l=-1}function u(){s||(s=!0,t(function(){s=!1,o()}))}u.sync=o;function d(h,g){if(g!=null&&g.view==null&&typeof g!="function")throw new TypeError("m.mount expects a component, not a vnode.");var m=r.indexOf(h);m>=0&&(r.splice(m,2),m<=l&&(l-=2),e(h,[])),g!=null&&(r.push(h,g),e(h,Jt(g),u))}return{mount:d,redraw:u}},nr=Vt,st=tr(nr,typeof requestAnimationFrame<"u"?requestAnimationFrame:null,typeof console<"u"?console:null),Ft=function(e){if(Object.prototype.toString.call(e)!=="[object Object]")return"";var t=[];for(var n in e)r(n,e[n]);return t.join("&");function r(s,l){if(Array.isArray(l))for(var o=0;o<l.length;o++)r(s+"["+o+"]",l[o]);else if(Object.prototype.toString.call(l)==="[object Object]")for(var o in l)r(s+"["+o+"]",l[o]);else t.push(encodeURIComponent(s)+(l!=null&&l!==""?"="+encodeURIComponent(l):""))}},rr=We,$t=Object.assign||function(e,t){for(var n in t)rr.call(t,n)&&(e[n]=t[n])},ir=Ft,ar=$t,ct=function(e,t){if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Template parameter names must be separated by either a '/', '-', or '.'.");if(t==null)return e;var n=e.indexOf("?"),r=e.indexOf("#"),s=r<0?e.length:r,l=n<0?s:n,o=e.slice(0,l),u={};ar(u,t);var d=o.replace(/:([^\/\.-]+)(\.{3})?/g,function(I,D,j){return delete u[D],t[D]==null?I:j?t[D]:encodeURIComponent(String(t[D]))}),h=d.indexOf("?"),g=d.indexOf("#"),m=g<0?d.length:g,M=h<0?m:h,N=d.slice(0,M);n>=0&&(N+=e.slice(n,s)),h>=0&&(N+=(n<0?"?":"&")+d.slice(h,m));var w=ir(u);return w&&(N+=(n<0&&h<0?"?":"&")+w),r>=0&&(N+=e.slice(r)),g>=0&&(N+=(r<0?"":"&")+d.slice(g)),N},or=ct,_t=We,sr=function(e,t,n){var r=0;function s(u){return new t(u)}s.prototype=t.prototype,s.__proto__=t;function l(u){return function(d,h){typeof d!="string"?(h=d,d=d.url):h==null&&(h={});var g=new t(function(w,I){u(or(d,h.params),h,function(D){if(typeof h.type=="function")if(Array.isArray(D))for(var j=0;j<D.length;j++)D[j]=new h.type(D[j]);else D=new h.type(D);w(D)},I)});if(h.background===!0)return g;var m=0;function M(){--m===0&&typeof n=="function"&&n()}return N(g);function N(w){var I=w.then;return w.constructor=s,w.then=function(){m++;var D=I.apply(w,arguments);return D.then(M,function(j){if(M(),m===0)throw j}),N(D)},w}}}function o(u,d){for(var h in u.headers)if(_t.call(u.headers,h)&&h.toLowerCase()===d)return!0;return!1}return{request:l(function(u,d,h,g){var m=d.method!=null?d.method.toUpperCase():"GET",M=d.body,N=(d.serialize==null||d.serialize===JSON.serialize)&&!(M instanceof e.FormData||M instanceof e.URLSearchParams),w=d.responseType||(typeof d.extract=="function"?"":"json"),I=new e.XMLHttpRequest,D=!1,j=!1,H=I,P,E=I.abort;I.abort=function(){D=!0,E.call(this)},I.open(m,u,d.async!==!1,typeof d.user=="string"?d.user:void 0,typeof d.password=="string"?d.password:void 0),N&&M!=null&&!o(d,"content-type")&&I.setRequestHeader("Content-Type","application/json; charset=utf-8"),typeof d.deserialize!="function"&&!o(d,"accept")&&I.setRequestHeader("Accept","application/json, text/*"),d.withCredentials&&(I.withCredentials=d.withCredentials),d.timeout&&(I.timeout=d.timeout),I.responseType=w;for(var k in d.headers)_t.call(d.headers,k)&&I.setRequestHeader(k,d.headers[k]);I.onreadystatechange=function(b){if(!D&&b.target.readyState===4)try{var z=b.target.status>=200&&b.target.status<300||b.target.status===304||/^file:\/\//i.test(u),T=b.target.response,A;if(w==="json"){if(!b.target.responseType&&typeof d.extract!="function")try{T=JSON.parse(b.target.responseText)}catch{T=null}}else(!w||w==="text")&&T==null&&(T=b.target.responseText);if(typeof d.extract=="function"?(T=d.extract(b.target,d),z=!0):typeof d.deserialize=="function"&&(T=d.deserialize(T)),z)h(T);else{var Q=function(){try{A=b.target.responseText}catch{A=T}var Y=new Error(A);Y.code=b.target.status,Y.response=T,g(Y)};I.status===0?setTimeout(function(){j||Q()}):Q()}}catch(Y){g(Y)}},I.ontimeout=function(b){j=!0;var z=new Error("Request timed out");z.code=b.target.status,g(z)},typeof d.config=="function"&&(I=d.config(I,d,u)||I,I!==H&&(P=I.abort,I.abort=function(){D=!0,P.call(this)})),M==null?I.send():typeof d.serialize=="function"?I.send(d.serialize(M)):M instanceof e.FormData||M instanceof e.URLSearchParams?I.send(M):I.send(JSON.stringify(M))}),jsonp:l(function(u,d,h,g){var m=d.callbackName||"_mithril_"+Math.round(Math.random()*1e16)+"_"+r++,M=e.document.createElement("script");e[m]=function(N){delete e[m],M.parentNode.removeChild(M),h(N)},M.onerror=function(){delete e[m],M.parentNode.removeChild(M),g(new Error("JSONP request failed"))},M.src=u+(u.indexOf("?")<0?"?":"&")+encodeURIComponent(d.callbackKey||"callback")+"="+encodeURIComponent(m),e.document.documentElement.appendChild(M)})}},cr=Ce.exports,lr=st,ur=sr(typeof window<"u"?window:null,cr,lr.redraw);function Xt(e){try{return decodeURIComponent(e)}catch{return e}}var Kt=function(e){if(e===""||e==null)return{};e.charAt(0)==="?"&&(e=e.slice(1));for(var t=e.split("&"),n={},r={},s=0;s<t.length;s++){var l=t[s].split("="),o=Xt(l[0]),u=l.length===2?Xt(l[1]):"";u==="true"?u=!0:u==="false"&&(u=!1);var d=o.split(/\]\[?|\[/),h=r;o.indexOf("[")>-1&&d.pop();for(var g=0;g<d.length;g++){var m=d[g],M=d[g+1],N=M==""||!isNaN(parseInt(M,10));if(m===""){var o=d.slice(0,g).join();n[o]==null&&(n[o]=Array.isArray(h)?h.length:0),m=n[o]++}else if(m==="__proto__")break;if(g===d.length-1)h[m]=u;else{var w=Object.getOwnPropertyDescriptor(h,m);w!=null&&(w=w.value),w==null&&(h[m]=w=N?[]:{}),h=w}}}return r},dr=Kt,lt=function(e){var t=e.indexOf("?"),n=e.indexOf("#"),r=n<0?e.length:n,s=t<0?r:t,l=e.slice(0,s).replace(/\/{2,}/g,"/");return l?(l[0]!=="/"&&(l="/"+l),l.length>1&&l[l.length-1]==="/"&&(l=l.slice(0,-1))):l="/",{path:l,params:t<0?{}:dr(e.slice(t+1,r))}},hr=lt,gr=function(e){var t=hr(e),n=Object.keys(t.params),r=[],s=new RegExp("^"+t.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,function(l,o,u){return o==null?"\\"+l:(r.push({k:o,r:u==="..."}),u==="..."?"(.*)":u==="."?"([^/]+)\\.":"([^/]+)"+(u||""))})+"$");return function(l){for(var o=0;o<n.length;o++)if(t.params[n[o]]!==l.params[n[o]])return!1;if(!r.length)return s.test(l.path);var u=s.exec(l.path);if(u==null)return!1;for(var o=0;o<r.length;o++)l.params[r[o].k]=r[o].r?u[o+1]:decodeURIComponent(u[o+1]);return!0}},qt=We,en=new RegExp("^(?:key|oninit|oncreate|onbeforeupdate|onupdate|onbeforeremove|onremove)$"),tn=function(e,t){var n={};if(t!=null)for(var r in e)qt.call(e,r)&&!en.test(r)&&t.indexOf(r)<0&&(n[r]=e[r]);else for(var r in e)qt.call(e,r)&&!en.test(r)&&(n[r]=e[r]);return n},fr=ge,mr=Bt,pr=Ce.exports,nn=ct,rn=lt,Mr=gr,br=$t,yr=tn,ut={};function Ir(e){try{return decodeURIComponent(e)}catch{return e}}var Nr=function(e,t){var n=e==null?null:typeof e.setImmediate=="function"?e.setImmediate:e.setTimeout,r=pr.resolve(),s=!1,l=!1,o=0,u,d,h=ut,g,m,M,N,w={onbeforeupdate:function(){return o=o?2:1,!(!o||ut===h)},onremove:function(){e.removeEventListener("popstate",j,!1),e.removeEventListener("hashchange",D,!1)},view:function(){if(!(!o||ut===h)){var E=[fr(g,m.key,m)];return h&&(E=h.render(E[0])),E}}},I=P.SKIP={};function D(){s=!1;var E=e.location.hash;P.prefix[0]!=="#"&&(E=e.location.search+E,P.prefix[0]!=="?"&&(E=e.location.pathname+E,E[0]!=="/"&&(E="/"+E)));var k=E.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,Ir).slice(P.prefix.length),b=rn(k);br(b.params,e.history.state);function z(A){console.error(A),H(d,null,{replace:!0})}T(0);function T(A){for(;A<u.length;A++)if(u[A].check(b)){var Q=u[A].component,Y=u[A].route,te=Q,ne=N=function(L){if(ne===N){if(L===I)return T(A+1);g=L!=null&&(typeof L.view=="function"||typeof L=="function")?L:"div",m=b.params,M=k,N=null,h=Q.render?Q:null,o===2?t.redraw():(o=2,t.redraw.sync())}};Q.view||typeof Q=="function"?(Q={},ne(te)):Q.onmatch?r.then(function(){return Q.onmatch(b.params,k,Y)}).then(ne,k===d?null:z):ne("div");return}if(k===d)throw new Error("Could not resolve default route "+d+".");H(d,null,{replace:!0})}}function j(){s||(s=!0,n(D))}function H(E,k,b){if(E=nn(E,k),l){j();var z=b?b.state:null,T=b?b.title:null;b&&b.replace?e.history.replaceState(z,T,P.prefix+E):e.history.pushState(z,T,P.prefix+E)}else e.location.href=P.prefix+E}function P(E,k,b){if(!E)throw new TypeError("DOM element being rendered to does not exist.");if(u=Object.keys(b).map(function(T){if(T[0]!=="/")throw new SyntaxError("Routes must start with a '/'.");if(/:([^\/\.-]+)(\.{3})?:/.test(T))throw new SyntaxError("Route parameter names must be separated with either '/', '.', or '-'.");return{route:T,component:b[T],check:Mr(T)}}),d=k,k!=null){var z=rn(k);if(!u.some(function(T){return T.check(z)}))throw new ReferenceError("Default route doesn't match any known routes.")}typeof e.history.pushState=="function"?e.addEventListener("popstate",j,!1):P.prefix[0]==="#"&&e.addEventListener("hashchange",D,!1),l=!0,t.mount(E,w),D()}return P.set=function(E,k,b){N!=null&&(b=b||{},b.replace=!0),N=null,H(E,k,b)},P.get=function(){return M},P.prefix="#!",P.Link={view:function(E){var k=mr(E.attrs.selector||"a",yr(E.attrs,["options","params","selector","onclick"]),E.children),b,z,T;return(k.attrs.disabled=Boolean(k.attrs.disabled))?(k.attrs.href=null,k.attrs["aria-disabled"]="true"):(b=E.attrs.options,z=E.attrs.onclick,T=nn(k.attrs.href,E.attrs.params),k.attrs.href=P.prefix+T,k.attrs.onclick=function(A){var Q;typeof z=="function"?Q=z.call(A.currentTarget,A):z==null||typeof z!="object"||typeof z.handleEvent=="function"&&z.handleEvent(A),Q!==!1&&!A.defaultPrevented&&(A.button===0||A.which===0||A.which===1)&&(!A.currentTarget.target||A.currentTarget.target==="_self")&&!A.ctrlKey&&!A.metaKey&&!A.shiftKey&&!A.altKey&&(A.preventDefault(),A.redraw=!1,P.set(T,null,b))}),k}},P.param=function(E){return m&&E!=null?m[E]:m},P},xr=st,wr=Nr(typeof window<"u"?window:null,xr),Be=qn,an=ur,on=st,F=function(){return Be.apply(this,arguments)};F.m=Be,F.trust=Be.trust,F.fragment=Be.fragment,F.Fragment="[",F.mount=on.mount,F.route=wr,F.render=Vt,F.redraw=on.redraw,F.request=an.request,F.jsonp=an.jsonp,F.parseQueryString=Kt,F.buildQueryString=Ft,F.parsePathname=lt,F.buildPathname=ct,F.vnode=ge,F.PromisePolyfill=Gt,F.censor=tn;var x=F;const xe=e=>new Promise(t=>setTimeout(t,e)),Dr=he("client");function vr(){return new Proxy({},{get:function(t,n,r){return(...s)=>{Dr(n,...s);const l=new Promise((o,u)=>{try{chrome.runtime.sendMessage({command:n,args:s},d=>{if(!d){u(new Error("Cannot connect to background service"));return}d.ok?o(d.result):u(d.error)})}catch(d){u(d)}});return Promise.race([l,xe(5e3).then(()=>{throw new Error("Cannot connect to background service")})])}}})}function Tr(){let e=!0;return{async hasIdentityPermission(){return e},async requestIdentityPermission(){return Math.random()>.5&&(e=!0),e},async getBrowserAccount(){if(!!e)return{email:"FallenMax@gmail.com"}},async openOptionsPage(){console.log("open options")}}}const sn=e=>{const t=()=>{};return t.basePath=e,new Proxy(t,{get(n,r){if(typeof r!="string"&&typeof r!="number")throw new TypeError("expects string or number");return sn(`${n.basePath}/${r}`)},apply(n,r,[s]){return fetch(n.basePath,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then(l=>{if(!l.ok||l.status>299)throw new Error(`${l.status} ${l.statusText}`);return l.json()}).catch(l=>{throw l&&l.response?l.response:l})}})},dt=sn(An),Ar="smart-toc-pro",Er={queryStartTrial(e){return e?.startTrialReason},async startTrial(e){const t=await this.fetchProductInfo(e);return Ee(e),Ee(t.product),await dt.customer.startTrial({email:e,productId:t.product.id})},getPrivilegeType(e){return e?e.privilege:{type:"free"}},queryClaimPaid(e){return e?.claimPaidReason},async claimPaid(e,t){const n=await this.fetchProductInfo(e);return Ee(n.product),await dt.customer.claimPaid({email:e,productId:n.product.id,method:t})},async fetchProductInfo(e){return await dt.customer.getProductInfo({email:e,productId:Ar})}};class ht{constructor(){this.disposers=[],this.isDisposed=!1,this.R=t=>(Ee(!this.isDisposed,"trying to R() after dispose"),this.disposers.push(t),t),this.dispose=()=>{if(this.isDisposed){q&&console.warn("[smarttoc] trying to dispose() after dispose");return}this.isDisposed=!0,this.disposers.reverse().forEach(t=>{typeof t=="function"?t():t.dispose()}),this.disposers=[]}}}class Le extends ht{constructor(){super(),this.handlerMap=new Map,this.R(()=>this.offAll())}on(t,n){let r=this.handlerMap.get(t)||new Set;return r.add(n),this.handlerMap.set(t,r),()=>this.off(t,n)}off(t,n){let r=this.handlerMap.get(t)||new Set;r.delete(n),this.handlerMap.set(t,r)}emit(t,n){const r=this.handlerMap.get(t);if(r)for(const s of r)s(n)}offAll(){this.handlerMap=new Map}}const jr=he("storage");class Cr extends Le{constructor(t){super(),this.cached={},this.onChange=async()=>{await this.get(),this.emit("changed",void 0)},chrome.storage.onChanged.addListener(this.onChange),q&&typeof globalThis<"u"&&(globalThis.__store=this),this.R(()=>chrome.storage.onChanged.removeListener(this.onChange))}async get(){const t=await new Promise((n,r)=>{chrome.storage.sync.get(n)});return jr(t),this.cached=t,t}getCached(){return this.cached}async patch(t){const n=Object.keys(t).filter(r=>t[r]==null);await new Promise((r,s)=>{chrome.storage.sync.set(t,r)}),n.length&&await new Promise((r,s)=>{chrome.storage.sync.remove(n,r)}),await this.get()}async DEBUG_reset(){await new Promise((t,n)=>{chrome.storage.sync.clear(t)}),await this.get()}}class zr extends Le{constructor(t){super(),this.cached={}}async get(){return this.cached}getCached(){return this.cached}async patch(t){const n=Object.keys(t).filter(r=>t[r]==null);if(Object.assign(this.cached,t),n.length)for(const r of n)delete this.cached[r]}async DEBUG_reset(){this.cached={}}}var hi=(()=>`#smarttoc-base{--highlight-border-width: 3px;--highlight-color: #563d7c;--hover-color: rgba(86, 61, 124, .5);--text-color: #808080;--background-color: white;--border-color: #e5e5e5;--border-color-inactive: #e5e5e581;--match-highlight-color: yellow;--scrollbar-color: #d9dadb;--zindex-panel: 10000000;--zindex-toolbar: calc(var(--zindex-panel) + 10);--zindex-searchbar: calc(var(--zindex-panel) + 20);--zindex-resizer: calc(var(--zindex-panel) + 30);--zindex-tooltip: calc(var(--zindex-panel) + 40)}#smarttoc-base,#smarttoc-base *,#smarttoc-base *:after,#smarttoc-base *:before{all:revert}#smarttoc-base *{margin:0;padding:0}#smarttoc-base a,#smarttoc-base a.visited,#smarttoc-base a.active{text-decoration:none}#smarttoc-base li{display:block;list-style:none}#smarttoc-base ul{display:block;padding:0;margin:0}#smarttoc-base input{border:none;outline:none;user-select:none;background:none;font:inherit;appearance:none;box-shadow:none}#smarttoc-base button{border:none;outline:none;cursor:pointer;user-select:none;background:none;font:inherit;appearance:none;box-shadow:none;pointer-events:auto!important}#smarttoc-base .icon{width:16px;height:16px;flex-shrink:0;background-repeat:no-repeat;background-position:center;background-size:contain}#smarttoc-base[data-theme=dark]{--highlight-color: #bb86fc;--hover-color: rgba(187, 134, 252, .5);--text-color: #808080;--background-color: #252525;--border-color: #5e5e5e38;--border-color-inactive: #5e5e5e38;--match-highlight-color: yellow;--scrollbar-color: #d9dadb33}#smarttoc-base.smarttoc-transition,#smarttoc-base.smarttoc-transition *,#smarttoc-base.smarttoc-transition *:before,#smarttoc-base.smarttoc-transition *:after{transition:background .3s ease,color .3s ease!important}
`)();const gt="smarttoc-base",cn=e=>{const t=document.createElement("textarea");t.style.position="fixed",t.style.top="0",t.style.opacity="0",document.body.appendChild(t),t.value=e,t.select();const n=document.execCommand("copy");if(document.body.removeChild(t),!n)throw new Error("failed to copy")},Lr=e=>{function t(n){n.clipboardData.setData("text/html",e),n.preventDefault()}document.addEventListener("copy",t),document.execCommand("copy"),document.removeEventListener("copy",t)};class Sr{constructor(){this.record=new Set}reset(){this.record=new Set}expand(t){this.record.add(t)}fold(t){this.record.delete(t)}getMaxExpandedLevel(){const t=[...this.record.keys()].map(n=>n.split(".").filter(Boolean).length+1);return Math.max(1,...t)}isExpanded(t){return this.record.has(t)}toJSON(){return Array.from(this.record)}fromJSON(t){this.record=new Set(t)}}const Hr=e=>{if(!e.length)return;let[t,...n]=e,r=t.parentElement;if(!!r){for(const s of n){if(!document.documentElement.contains(s)){console.warn("[smarttoc] element not in document",s);return}for(;!r.contains(s);)if(r=r.parentElement,!r)return}return r??void 0}};class Pr extends ht{constructor(t){super(),this.options={},this.disposeExtender=()=>{this.$extender?.remove(),this.$extender=void 0},ke(this,"extender"),this.setOptions(t,!0,!0),this.R(()=>this.disposeExtender())}setOptions(t,n=!1,r=!1){const s=n?t:{...this.options,...t};this.options=s,S.withEventMuted(()=>{this.updateExtender()})()}updateExtender(){this.options.content?this.$extender&&this.options.content.article.contains(this.$extender)||this.disposeExtender():this.disposeExtender();const{content:t,measurements:n}=this.options;if(!(t&&n))return;if(!this.$extender){this.$extender=zn("div",{id:"smarttoc-extender"});const N=Hr(t.headings.map(w=>w.dom).slice(0,10))||t.scroller;S.append(N,this.$extender,!0)}const{scroller:r}=t,{scrollerRect:s,headingRects:l}=n,o=l.slice().sort((N,w)=>w.bottom-N.bottom)[0];if(o==null){console.error("[smarttoc] failed to update extender: invalid headingRects");return}const u=s.height,d=o.height,h=s.bottom+r.scrollHeight-s.height-o.bottom,g=u-(this.options.spaceFromTop??0)-d-h,m=S.fromPx(this.$extender.style.height),M=Math.max(0,m+g);this.$extender.style.height=String(M)+"px"}}const ln=(e,t,n)=>{const r=(t.left+t.right)/2,s=e.x,l=e.x+(e.width??n),u=(s+l)/2>r?"right":"left",d=u==="right"?s-t.right:l-t.left,h=e.y-fe.gapTop;return{placement:u,dx:d,dy:h}},Or=(e,t,n,r)=>{const s=e.placement==="right"?t.right+e.dx:t.left+e.dx-(r?.width??n),l=fe.gapTop+e.dy;return{x:s,y:l,width:r?.width,height:r?.height}},un=(e,t,n)=>{const[r,s]=n;let{x:l,y:o,width:u,height:d}=e;const{innerWidth:h,innerHeight:g}=window;return l=ce(r,l,h-(u??t.width)-r),o=ce(s,o,g-(d??t.height)-s),{x:l,y:o,width:u,height:d}},dn=(e,t)=>{let{width:n,height:r,x:s,y:l}=e;n!=null?(n=Math.round(n),t.style.width=n+"px",t.style.minWidth=n+"px",t.style.maxWidth=n+"px"):(t.style.width="",t.style.minWidth="",t.style.maxWidth=""),r!=null?(r=Math.round(r),t.style.height=r+"px",t.style.minHeight=r+"px",t.style.maxHeight=r+"px"):(t.style.height="",t.style.minHeight="",t.style.maxHeight=""),s=Math.round(s),l=Math.round(l),t.style.transform=`translate(${s}px, ${l}px)`},hn=(()=>({top:0,left:(window.innerWidth-800)/2,right:(window.innerWidth-800)/2+800,bottom:2e3,width:800,height:2e3}))(),U=class extends Le{constructor(e){super(),this.setSpaceFromTop(e.spaceFromTop),this.R(S.listen(window,"resize",()=>this.adjustPosition())),ke(this,"positioner")}isPositioned(){return U.absPos!=null}setAbsPos(e,t=!1){!this.panel||((!this.panelRect||t)&&(this.panelRect=this.panel.getBoundingClientRect()),(!U.articleRect||t)&&(U.articleRect=U.article?.getBoundingClientRect()??hn),U.absPos=un(e,this.panelRect,U.gap),U.relPos=ln(U.absPos,U.articleRect,this.panelRect.width),dn(U.absPos,this.panel))}setRelPos(e,t=!1){!this.panel||((!this.panelRect||t)&&(this.panelRect=this.panel.getBoundingClientRect()),(!U.articleRect||t)&&(U.articleRect=U.article?.getBoundingClientRect()??hn),U.absPos=un(Or(e,U.articleRect,this.panelRect.width,U.absPos),this.panelRect,U.gap),U.relPos=ln(U.absPos,U.articleRect,this.panelRect.width),dn(U.absPos,this.panel))}adjustPosition(){this.setRelPos(U.relPos,!0)}setPanel(e){e!==this.panel&&(this.panel=e,this.adjustPosition())}setSpaceFromTop(e){}setArticle(e){U.article!==e&&(U.article=e,this.adjustPosition())}};let fe=U;fe.gapTop=window.innerHeight*.1,fe.gap=[20,10],fe.relPos={placement:"right",dx:U.gap[0],dy:0};const gn=e=>{const t=e.replace(/^#/i,"");if(!/^\w{6,8}$/.test(t))return;const[n,r,s,l]=[t.slice(0,2),t.slice(2,4),t.slice(4,6),t.slice(6,8)].map(o=>{if(o==null)return o;if(o!=="")return Number.parseInt(o,16)});if([n,r,s].every(o=>typeof o=="number"&&o===o))return{r:n,g:r,b:s,a:l}},kr=e=>{if(!/^rgba?/i.test(e))return;const t=e.replace(/^rgba?/i,""),[n,r,s,l]=t.slice(1,-1).split(/, ?/).map(o=>Number(o));return{r:n,g:r,b:s,a:l}},fn=e=>("00"+e).slice(-2),ft=class{};let we=ft;we.parse=e=>/^#/i.test(e)?gn(e):/^rgba?/i.test(e)?kr(e):gn("#"+e),we.toHex=(e,{ignoreAlpha:t=!0}={})=>{if(typeof e=="string"){const d=ft.parse(e);return d?ft.toHex(d):""}const{r:n,g:r,b:s,a:l}=e,o=[n,r,s].map(d=>fn(Math.round(Number(d)).toString(16))).join("").toUpperCase(),u=t||l==null||l===255?"":fn(Math.round(Number(l)*255).toString(16)).toUpperCase();return"#"+o+u};const mn="smarttoc-transition";class Zr{static withCssTransition(t){const n=document.querySelectorAll(`#${gt}`);n.forEach(r=>{r.classList.add(mn)}),t(),setTimeout(function(){n.forEach(r=>{r.classList.remove(mn)})},300)}}const pn=({r:e,g:t,b:n,a:r})=>Math.sqrt(.299*(e*e)+.587*(t*t)+.114*(n*n)),mt=e=>{if(!e)return we.parse("#000000");const t=we.parse(window.getComputedStyle(e).color);return!t||t.a===0?mt(e.parentElement):t},pt=e=>{if(!e)return we.parse("#ffffff");const t=we.parse(window.getComputedStyle(e).backgroundColor);return!t||t.a===0?pt(e.parentElement):t},Ge=class{static detectPageTheme(e){let t=e,n=e.getBoundingClientRect();for(const u of S.walkTree(e)){const d=u,h=d.getBoundingClientRect();h.width>n.width&&h.height>n.height&&(n=h,t=d)}const r=mt(t),s=pt(t),l=pn(r),o=pn(s);return l<=o?"light":"dark"}static detectSystemTheme(){const e=window.matchMedia("(prefers-color-scheme: dark)").matches,t=window.matchMedia("(prefers-color-scheme: light)").matches;if(e)return"dark";if(t)return"light"}};let ae=Ge;ae.updateTheme=e=>{const t=e??Ge.themePage??"light";Ge.theme!==t&&Zr.withCssTransition(()=>{Ge.theme=t,window.smarttoc||(window.smarttoc={}),window.smarttoc.theme=t,x.redraw()})};const Mn=(e,t)=>{let n,r;const s=(...l)=>{n&&(clearTimeout(n),n=void 0,r=void 0),r=l,n=window.setTimeout(()=>{e.apply(t.self||null,r),n=void 0,r=void 0},t.delay)};return s.consume=()=>{n&&(clearTimeout(n),e.apply(t.self||null,r),n=void 0,r=void 0)},s.drop=()=>{n&&(clearTimeout(n),n=void 0,r=void 0)},s},Ur=(e,t)=>{if(e=e||ue.extractArticle({headingSelectors:t}),!e)return;const n=S.get(e);if(!(n&&S.isElemVisible(n)))return;const r=ue.extractHeadings({articleDom:n,headingSelectors:t}),s=r.headings;if(t=r.headingSelectors,!s.length||!s.some(h=>S.isElemVisible(h.dom)))return;const l=nt(n);if(!l)return;const o=document.documentElement===l||document.documentElement.contains(l),u=l===e||l.contains(n),d=s.length&&n.contains(s[0].dom)&&n.contains(s[s.length-1].dom);if(o&&u&&d){const h=Math.max(...s.map(g=>g.level))+1;return{article:n,headings:s,maxLevel:h,headingSelectors:t,scroller:l}}else{console.warn("[smarttoc] invalid content:",{articleElem:n,scroller:l,headings:s,isScrollerValid:o,isArticleValid:u,isHeadingsValid:d});return}},Rr=(e,t,n)=>{if(!e||!t)return-1;const{scroller:r}=e,s=t,l=n+s.scrollerRect.top,o=Ae(r),u=s.headingRects.length;if(u<=1)return 0;let d=0,h=u,g=Math.floor((d+h)/2);for(;;){if(d>=h-1)return s.headingSortedByY[d][1];const[m]=s.headingSortedByY[g];m-o>=l+1?h=g:d=g,g=Math.floor((d+h)/2)}},Qr=e=>{if(!S.isElemVisible(e.article)||e.headings.every(u=>!S.isElemVisible(u.dom)))return;const t=St(e.scroller),n=Ae(e.scroller),r=({top:u,left:d,right:h,bottom:g,height:m,width:M})=>({top:u+n,bottom:g+n,left:d,right:h,height:m,width:M}),s=r(e.article.getBoundingClientRect()),l=e.headings.map((u,d)=>{const h=S.getVisibleTextRect(u.dom),g=u.dom.getBoundingClientRect(),m={left:g.left,right:g.right,top:h?h.top:g.top,bottom:h?h.bottom:g.bottom};return{...m,height:m.bottom-m.top,width:m.right-m.left}}).map(r),o=l.map((u,d)=>[u.top,d]).sort((u,d)=>u[0]-d[0]);return{articleRect:s,scrollerRect:t,headingRects:l,headingSortedByY:o}};class Yr extends Le{constructor(t){super(),this.hadContent=!1,this.options={},this.logger=he("watcher"),this.updateActiveHeading=()=>{const n=this.content&&this.measurements&&Rr(this.content,this.measurements,this.options.spaceFromTop??0);n!==this.activeHeading&&(this.activeHeading=n,this.emit("activeHeadingChanged",this.activeHeading))},this.unListen=pe,this.retryCount=0,this.updateContent=()=>{const n=this.content;this.content=Ur(this.options.article??n?.article,this.options.headingSelectors),this.content&&(this.hadContent=!0),this.content?.article!==n?.article&&this.emit("articleChanged",this.content?.article),le(this.content?.headings,n?.headings)||this.emit("headingsChanged",this.content?.headings),this.updateMeasurements(),this.unListen(),this.unlistenUrlChange(),this.content?this.listenOnChange():this.listenOnUrlChange(),!this.content&&this.hadContent?setTimeout(()=>{!this.content&&this.retryCount<=3&&(this.logger(`retrying ${this.retryCount}`),this.retryCount++,this.updateContent())},1e3):this.retryCount=0},this.unlistenUrlChange=pe,this.updateMeasurements=(n=!1)=>{const r=this.measurements;if(this.measurements=this.content&&Qr(this.content),this.content&&!this.measurements){this.updateContent();return}const s=le(this.measurements?.articleRect,r?.articleRect,{numberTolerance:1})&&le(this.measurements?.scrollerRect,r?.scrollerRect,{numberTolerance:1})&&le(this.measurements?.headingRects.length,r?.headingRects.length);!n&&!s&&(this.emit("measurementsChanged",this.measurements),this.updateActiveHeading())},ke(this,"watcher"),this.setOptions(t,!0,!0),this.R(()=>{this.unListen(),this.unlistenUrlChange()}),this.updateContentDebounced=Mn(this.updateContent,{delay:this.options.detectDelay??300}),this.updateMeasurementsDebounced=Mn(this.updateMeasurements,{delay:this.options.detectDelay??300})}consumePendingTasks(){this.updateContentDebounced?.consume(),this.updateMeasurementsDebounced?.consume()}dropPendingTasks(){this.updateContentDebounced?.drop(),this.updateMeasurementsDebounced?.drop()}getHeadingRect(t){if(!this.measurements||!this.content)return;const n={...this.measurements.headingRects[t]},r=Ae(this.content.scroller);return n.top-=r,n.bottom-=r,n}setOptions(t,n=!1,r=!1){const s=this.options,l=n?t:{...this.options,...t};this.options=l;const o=u=>!le(l[u],s[u]);r||o("article")||o("headingSelectors")?this.updateContent():o("spaceFromTop")&&this.updateActiveHeading()}async scrollToHeading(t,n){const r=async()=>{if(!this.content)throw new Error("content not available");const{scroller:o,headings:u}=this.content,d=this.getHeadingRect(t);if(!d)throw new Error("headings not available");await Hn({targetTop:d.top,scroller:o,spaceFromTop:this.options.spaceFromTop??0,maxDuration:n}),this.dropPendingTasks(),this.updateMeasurements(),this.updateActiveHeading()};let s=this.activeHeading,l=0;for(;;){if(this.logger(`scrollToHeading ${t} pass ${l} start`),await r(),this.logger(`scrollToHeading ${t} pass ${l} end`),this.activeHeading===t){this.logger(`scrollToHeading ${t} reached after ${l} passes`);break}if(this.activeHeading===s){this.logger(`scrollToHeading ${t} bailout: activeHeading not updated: ${this.activeHeading}`);break}s=this.activeHeading,await xe(0),l++}typeof this.activeHeading=="number"&&this.emit("scrolledToHeading",this.activeHeading)}getNextHeadingIndex(){return!this.content||this.activeHeading==null?void 0:(this.activeHeading+1)%this.content.headings.length}getPreviousHeadingIndex(){return!this.content||this.activeHeading==null?void 0:(this.activeHeading-1+this.content.headings.length)%this.content.headings.length}listenOnChange(){this.unListen();const t=new ht;if(this.content){const n=()=>this.content&&S.isElemVisible(this.content.article);t.R(S.onResize(this.content.article,s=>{this.logger("[event] article resize"),this.updateContentDebounced()})),t.R(S.onRemoveByPoll(this.content.article,()=>{this.logger("[event] article removed"),this.updateContentDebounced()},{delay:1e3}));const r=this.content.scroller===document.documentElement||this.content.scroller===document.body?window:this.content.scroller;t.R(S.listen(r,"scroll",()=>{n()?this.updateActiveHeading():this.updateContentDebounced()}))}this.unListen=()=>{t.dispose(),this.unListen=pe}}listenOnUrlChange(){this.unlistenUrlChange();let t=location.href,n=setInterval(()=>{location.href!==t&&(this.unlistenUrlChange(),this.updateContent())},1e3);this.unlistenUrlChange=()=>{clearInterval(n),this.unlistenUrlChange=pe}}}const Mt=e=>Object.keys(e).filter(t=>e[t]).join(" ");var gi=(()=>`#smarttoc-base .heading-text-position-holder{position:absolute;left:0;width:0;height:0;overflow:hidden}#smarttoc-base .heading{--heading-height: 24px;position:relative;display:block;border-left-color:transparent;border-left-style:solid;padding-left:var(--padding-left);border-left-width:var(--highlight-border-width);color:var(--text-color);cursor:pointer;text-overflow:ellipsis;line-height:var(--heading-height);white-space:nowrap;background-color:var(--background-color);display:flex;overflow:hidden;align-items:center}#smarttoc-base .heading .heading-text{flex-grow:1;overflow:hidden;position:relative}#smarttoc-base .heading .icon{width:20px;height:20px;background-size:16px 16px;opacity:.2;transition:opacity .3s ease-out}#smarttoc-base .heading .icon:hover,#smarttoc-base .heading .icon:focus-visible{opacity:.5}#smarttoc-base .heading .icon:active{opacity:.7}#smarttoc-base .heading:hover,#smarttoc-base .heading:focus-visible,#smarttoc-base .heading:active,#smarttoc-base .heading.is-current{color:var(--highlight-color);border-left-color:var(--hover-color);text-decoration:underline}#smarttoc-base .heading:focus{outline:none}#smarttoc-base .heading .part.match{background-color:var(--match-highlight-color);font-weight:bolder}#smarttoc-base .heading[data-level="0"]{--padding-left: 1.3em;--highlight-border-width: 3px}#smarttoc-base .heading[data-level="1"]{--padding-left: 2.7em;--highlight-border-width: 2px}#smarttoc-base .heading[data-level="2"]{--padding-left: 4em;--highlight-border-width: 1px}#smarttoc-base .heading[data-level="3"]{--padding-left: 5.3em;--highlight-border-width: 1px;border-left-style:dashed}#smarttoc-base .heading[data-level="4"]{--padding-left: 6.6em;--highlight-border-width: 1px;border-left-style:dotted}#smarttoc-base .heading[data-level="5"]{--padding-left: 7.9em;--highlight-border-width: 1px;border-left-style:dotted}#smarttoc-base .heading[data-level="6"]{--padding-left: 9.2em;--highlight-border-width: 1px;border-left-style:dotted}#smarttoc-base .heading.is-active{color:var(--highlight-color);border-left-color:var(--highlight-color);font-weight:700}#smarttoc-base .heading.is-active.breadcrumb{position:sticky;z-index:1}#smarttoc-base .heading.is-active.breadcrumb[data-level="0"]{top:calc(0 * var(--heading-height))}#smarttoc-base .heading.is-active.breadcrumb[data-level="1"]{top:calc(1 * var(--heading-height))}#smarttoc-base .heading.is-active.breadcrumb[data-level="2"]{top:calc(2 * var(--heading-height))}#smarttoc-base .heading.is-active.breadcrumb[data-level="3"]{top:calc(3 * var(--heading-height))}#smarttoc-base .heading.is-active.breadcrumb[data-level="4"]{top:calc(4 * var(--heading-height))}#smarttoc-base .heading.is-active.breadcrumb[data-level="5"]{top:calc(5 * var(--heading-height))}#smarttoc-base .heading.is-active.breadcrumb[data-level="6"]{top:calc(6 * var(--heading-height))}#smarttoc-base .heading .debug-info{position:absolute;right:0;top:0;background-color:var(--background-color);width:60px;text-align:right;font-size:smaller}#smarttoc-base .heading .icon-expand{display:none;position:absolute;left:var(--padding-left);top:50%;transform:translate(-100%,-50%);background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTUuNzUgMy41TDEwLjI1IDhMNS43NSAxMi41IiBzdHJva2U9ImJsYWNrIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPC9zdmc+Cg==);transition:transform .1s ease-in}#smarttoc-base .heading .icon-expand.is-expanded{transform:translate(-100%,-50%) rotate(90deg)}#smarttoc-base .heading.theme-dark .icon-expand{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTUuNzUgMy41TDEwLjI1IDhMNS43NSAxMi41IiBzdHJva2U9IndoaXRlIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPC9zdmc+Cg==)}#smarttoc-base .heading:hover .icon-expand{display:block}#smarttoc-base .heading .search-info{background-color:var(--background-color);color:var(--highlight-color);font-weight:bolder;margin-left:10px;text-align:right;font-size:smaller}
`)();const bn=()=>({view({attrs:{nodes:e,context:t}}){return e?.length?e.filter(t.shouldShow).map((n,r)=>x(Br,{key:n.value.heading?.index??"id-"+r,node:n,context:t})):void 0}}),Wr=({search:e,text:t})=>{let n;const r=e.toLowerCase(),s=t.toLowerCase();let l=0;const o=[];for(;;){const u=s.indexOf(r,l);if(u===-1)break;const d=u+r.length;o.push({type:"other",text:t.substring(l,u)}),o.push({type:"match",text:t.substring(u,d)}),l=d}return o.push({type:"other",text:t.substring(l)}),n=o.filter(u=>u.text).map(u=>x("span.part",{class:u.type==="match"?"match":""},u.text)),n},Br=()=>{let e=!0;return{view({attrs:{node:t,context:n}}){const r=t.value,s=n.isExpanded(t),l=n.search,o=r.heading,u=r.rect,d=o?.text;s!=null&&(e=s),n.canExpand(t);const h=q&&o&&u?`${o.index}-${Math.round(u.top)} `:"",g=t.value.containsMatch?`(${t.value.containsMatch})`:"",m=l&&d&&t.value.match?Wr({text:d,search:l}):o?.text;return[o&&x("a.heading",{"data-index":o.index,"data-level":r.level,className:Mt({"is-active":r.active||r.containsActive,"is-current":r.active,breadcrumb:n.breadcrumb,[`theme-${ae.theme??"light"}`]:!0}),href:o.anchor,title:o.text},[x("span.heading-text",[m]),h&&x(".debug-info",h),g&&x(".search-info",g)]),o&&(r.active||r.containsActive)&&x(".heading-text-position-holder",{"data-index":o.index}),e&&x(bn,{nodes:t.children,context:n})]}}};var fi=(()=>`@charset "UTF-8";#smarttoc-base.smarttoc-panel{display:flex;flex-direction:column;position:fixed;z-index:var(--zindex-panel);left:0;top:0;overflow:hidden;box-sizing:border-box;font-family:BlinkMacSystemFont,PingFang SC,Helvetica,Tahoma,Arial,Microsoft YaHei,\\5fae\\8f6f\\96c5\\9ed1,\\9ed1\\4f53,Heiti,sans-serif,SimSun,\\5b8b\\4f53,serif;font-size:calc(12px + .1vw);font-weight:400;line-height:1.5;-webkit-font-smoothing:subpixel-antialiased;font-smoothing:subpixel-antialiased;transition:box-shadow .3s ease-out;transition-property:box-shadow,border;will-change:transform;max-width:375px;min-width:300px;max-height:80vh;padding-top:22px;background:var(--background-color);border:1px solid var(--border-color-inactive)}#smarttoc-base.smarttoc-panel:hover{border:1px solid var(--border-color)}#smarttoc-base.smarttoc-panel .contents-wrapper{position:relative;overflow-x:hidden;overflow-y:auto;overscroll-behavior-y:contain;flex-grow:1;--scrollbarMargin: 3px;--scrollbarWidth: 6px;scrollbar-gutter:stable}#smarttoc-base.smarttoc-panel .contents-wrapper:hover{--scrollbarWidth: 6px}#smarttoc-base.smarttoc-panel .contents-wrapper::-webkit-scrollbar{width:calc(var(--scrollbarMargin) * 2 + var(--scrollbarWidth))}#smarttoc-base.smarttoc-panel .contents-wrapper::-webkit-scrollbar-thumb{border:var(--scrollbarMargin) solid rgba(0,0,0,0);background-clip:padding-box;border-radius:calc(var(--scrollbarMargin) * 2 + var(--scrollbarWidth));background-color:var(--scrollbar-color);display:none}#smarttoc-base.smarttoc-panel .contents-wrapper:hover::-webkit-scrollbar-thumb{display:block}#smarttoc-base.smarttoc-panel .contents-wrapper::-webkit-scrollbar-button{width:0;height:0;display:none}#smarttoc-base.smarttoc-panel .contents-wrapper::-webkit-scrollbar-corner{background-color:transparent}#smarttoc-base.smarttoc-panel .contents{padding:0 0 22px 12px}#smarttoc-base.smarttoc-panel .empty-placeholder{display:flex;align-items:center;justify-content:center;font-size:14px;color:var(--text-color);opacity:.8;min-height:30px}.smarttoc-heading{transition:background-color .3s ease!important}.smarttoc-heading--is-active{background-color:#bb86fc80}
`)(),mi=(()=>`#smarttoc-base .resizer{position:absolute;z-index:var(--zindex-resizer);background:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHZpZXdCb3g9IjAgMCAxMiAxMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEwIDJMMiAxME02LjUgMTBMMTAgNi41IiBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPgo8L3N2Zz4K) no-repeat center;background-size:contain;right:0;bottom:0;--size: 12px;width:var(--size);height:var(--size);cursor:nwse-resize}#smarttoc-base[data-theme=dark] .resizer{background:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTIiIHZpZXdCb3g9IjAgMCAxMiAxMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEwIDJMMiAxME02LjUgMTBMMTAgNi41IiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPgo8L3N2Zz4K) no-repeat center}#smarttoc-base .resizer{opacity:0}#smarttoc-base:hover .resizer,#smarttoc-base:focus-within .resizer{opacity:.15}#smarttoc-base .resizer:hover{opacity:.5}#smarttoc-base .resizer:active{opacity:.8}html.smarttoc--is-resizing{cursor:nwse-resize}
`)();const Gr=()=>{let e,t,n;const r=o=>{if(!n){console.warn("move when not dragging");return}const{clientX:u,clientY:d}=o,{horizontal:h,vertical:g,start:m}=n,M=u-m.clientX,N=d-m.clientY;if(!t)return;const{onChange:w}=t.attrs,{minHeight:I=0,maxHeight:D=1/0,minWidth:j=0,maxWidth:H=1/0}=t.attrs,P=g.start,k=ce(P+I,g.end+N,Math.min(window.innerHeight,P+D))-P,b=h.start,T=ce(b+j,h.end+M,Math.min(window.innerWidth,b+H))-b;w({left:b,top:P,width:T,height:k}),o.preventDefault()},s=o=>{document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",s),document.documentElement.classList.remove("smarttoc--is-resizing"),n=void 0,o.preventDefault()},l=o=>{if(n)return console.warn("is already resizing");if(!e)return console.warn("target not available");const u=e.getBoundingClientRect(),{clientX:d,clientY:h}=o;n={horizontal:{start:u.left,end:u.right},vertical:{start:u.top,end:u.bottom},start:{clientX:d,clientY:h}},document.documentElement.classList.add("smarttoc--is-resizing"),document.addEventListener("mousemove",r),document.addEventListener("mouseup",s),o.preventDefault()};return{oncreate(o){t=o,e=o.dom.parentElement},onbeforeupdate(o){t=o},view({attrs:o}){return x(".resizer",{ondblclick(){if(!e)return console.warn("target not available");const{left:u,top:d}=e.getBoundingClientRect();o.onChange({left:u,top:d,width:void 0,height:void 0})},onmousedown:l})}}};var pi=(()=>`#smarttoc-base .searchbar{position:absolute;z-index:var(--zindex-searchbar);left:0;right:0;top:0;transform:translateY(-100%);opacity:0;will-change:transform opacity;transition:all .1s ease-out;height:35px;display:flex;align-items:center;background:var(--background-color);padding:0 10px;border-bottom:1px solid var(--border-color)}#smarttoc-base .searchbar.is-active{transform:none;opacity:1}#smarttoc-base .searchbar .icon{opacity:.5}#smarttoc-base .searchbar input[type=search]::-webkit-search-decoration,#smarttoc-base .searchbar input[type=search]::-webkit-search-cancel-button,#smarttoc-base .searchbar input[type=search]::-webkit-search-results-button,#smarttoc-base .searchbar input[type=search]::-webkit-search-results-decoration{-webkit-appearance:none}#smarttoc-base .searchbar .search-input{appearance:none;flex-grow:1;margin:0 10px;height:100%;color:var(--text-color)}#smarttoc-base .search-icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTcuMDQ1NDMgMi43NUM2LjE5NTg4IDIuNzUgNS4zNjU0IDMuMDAxOTIgNC42NTkwMiAzLjQ3MzkxQzMuOTUyNjQgMy45NDU5IDMuNDAyMDggNC42MTY3NSAzLjA3Njk3IDUuNDAxNjRDMi43NTE4NiA2LjE4NjUzIDIuNjY2OCA3LjA1MDE5IDIuODMyNTQgNy44ODM0M0MyLjk5ODI4IDguNzE2NjYgMy40MDczOCA5LjQ4MjAzIDQuMDA4MSAxMC4wODI4QzQuNjA4ODMgMTAuNjgzNSA1LjM3NDIgMTEuMDkyNiA2LjIwNzQzIDExLjI1ODNDNy4wNDA2NyAxMS40MjQxIDcuOTA0MzMgMTEuMzM5IDguNjg5MjIgMTEuMDEzOUM5LjQ3NDExIDEwLjY4ODggMTAuMTQ1IDEwLjEzODIgMTAuNjE3IDkuNDMxODRDMTEuMDg4OSA4LjcyNTQ2IDExLjM0MDkgNy44OTQ5OCAxMS4zNDA5IDcuMDQ1NDNDMTEuMzQwOCA1LjkwNjIzIDEwLjg4ODIgNC44MTM3MiAxMC4wODI3IDQuMDA4MThDOS4yNzcxNCAzLjIwMjY1IDguMTg0NjMgMi43NTAwNyA3LjA0NTQzIDIuNzVWMi43NVoiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8cGF0aCBkPSJNMTAgMTBMMTQgMTQiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8L3N2Zz4K)}#smarttoc-base .search-close{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGc+CjxwYXRoIGQ9Ik0xMC4wNjI1IDMuOTM3NUwzLjkzNzUgMTAuMDYyNU0xMC4wNjI1IDEwLjA2MjVMMy45Mzc1IDMuOTM3NUwxMC4wNjI1IDEwLjA2MjVaIiBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8L2c+Cjwvc3ZnPgo=)}#smarttoc-base[data-theme=dark] .search-icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTcuMDQ1NDMgMi43NUM2LjE5NTg4IDIuNzUgNS4zNjU0IDMuMDAxOTIgNC42NTkwMiAzLjQ3MzkxQzMuOTUyNjQgMy45NDU5IDMuNDAyMDggNC42MTY3NSAzLjA3Njk3IDUuNDAxNjRDMi43NTE4NiA2LjE4NjUzIDIuNjY2OCA3LjA1MDE5IDIuODMyNTQgNy44ODM0M0MyLjk5ODI4IDguNzE2NjYgMy40MDczOCA5LjQ4MjAzIDQuMDA4MSAxMC4wODI4QzQuNjA4ODMgMTAuNjgzNSA1LjM3NDIgMTEuMDkyNiA2LjIwNzQzIDExLjI1ODNDNy4wNDA2NyAxMS40MjQxIDcuOTA0MzMgMTEuMzM5IDguNjg5MjIgMTEuMDEzOUM5LjQ3NDExIDEwLjY4ODggMTAuMTQ1IDEwLjEzODIgMTAuNjE3IDkuNDMxODRDMTEuMDg4OSA4LjcyNTQ2IDExLjM0MDkgNy44OTQ5OCAxMS4zNDA5IDcuMDQ1NDNDMTEuMzQwOCA1LjkwNjIzIDEwLjg4ODIgNC44MTM3MiAxMC4wODI3IDQuMDA4MThDOS4yNzcxNCAzLjIwMjY1IDguMTg0NjMgMi43NTAwNyA3LjA0NTQzIDIuNzVWMi43NVoiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8cGF0aCBkPSJNMTAgMTBMMTQgMTQiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8L3N2Zz4K)}#smarttoc-base[data-theme=dark] .search-close{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGc+CjxwYXRoIGQ9Ik0xMC4wNjI1IDMuOTM3NUwzLjkzNzUgMTAuMDYyNU0xMC4wNjI1IDEwLjA2MjVMMy45Mzc1IDMuOTM3NUwxMC4wNjI1IDEwLjA2MjVaIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8L2c+Cjwvc3ZnPgo=)}#smarttoc-base .searchbar-placeholder{height:0;will-change:height;transition:height .1s ease-out;flex-shrink:0}#smarttoc-base .searchbar-placeholder.is-active{height:20px}
`)();const Vr=()=>{let e;return{oncreate(t){e=t.dom},onbeforeupdate(t,n){const r=t.attrs.isActive&&!n.attrs.isActive;!t.attrs.isActive&&n.attrs.isActive,r&&setTimeout(function(){const s=e?.querySelector(".search-input");!s||(s.focus(),s.setSelectionRange(0,s.value.length))},0)},view({attrs:{isActive:t,search:n,onInput:r,onClose:s}}){return[x(".searchbar",{class:Mt({"is-active":t})},[x(".icon.search-icon"),x("input.search-input",{type:"search",value:n,placeholder:"Search",disabled:!t,oninput:r,onkeydown(l){l.key==="Escape"&&s?.()}}),x("button.icon.search-close",{disabled:!t,onclick:()=>{s();const l=e?.querySelector(".search-input");!l||l.blur()}})]),x(".searchbar-placeholder",{class:Mt({["is-active"]:t})})]}}};var Mi=(()=>`#smarttoc-base.smarttoc-tooltip{position:fixed;z-index:var(--zindex-tooltip);line-height:1.2;display:flex;flex-direction:row;justify-content:center;align-items:center;text-align:center;padding:6px 8px;min-height:20px;background:#8a8a8a;box-shadow:0 2px 8px #4e4e4e40;border-radius:2px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;line-height:1.5;font-weight:400;font-size:13px;color:#fff;white-space:nowrap}#smarttoc-base.smarttoc-tooltip[data-theme=dark]{background:#474747;color:#bebebe}
`)();let De,ve;const Jr=()=>({view(){const e=De?.getBoundingClientRect();if(!e||!ve)return;const t=window.innerHeight-e.bottom>60;return x(".smarttoc-tooltip",{id:gt,"data-theme":window.smarttoc?.theme??"light",style:{...t?{top:Math.round(e.bottom+6)+"px",transform:"translate(-50%, 0%)"}:{top:Math.round(e.top-6)+"px",transform:"translate(-50%, -100%)"},left:Math.round(e.left+e.width/2)+"px"}},ve)}}),Fr=(e,t=document.body)=>{let n=document.getElementById(e);return n||(n=document.createElement("div"),n.id=e,t.append(n)),n},be=()=>{let e,t,n,r=()=>{};const s=()=>{t||(t=Fr("smarttoc-tooltip")),x.render(t,x(Jr))},l=()=>{De=e,ve=n,s()},o=()=>{De===e&&(De=void 0,ve=void 0),s()},u=()=>{if(!e){console.warn("[smarttoc] cannot bind tooltip event for node");return}const d=e;d.addEventListener("pointerenter",l),d.addEventListener("pointerleave",o),d.addEventListener("focus",l),d.addEventListener("blur",o),r=()=>{d.removeEventListener("pointerenter",l),d.removeEventListener("pointerleave",o),d.removeEventListener("focus",l),d.removeEventListener("blur",o)}};return{oncreate(d){if(e=d.dom,!(e instanceof HTMLElement)){console.warn("[smarttoc] cannot display tooltip for node");debugger;return}u()},oninit(d){n=d.attrs.title,De===e&&(ve=n)},onupdate(d){d.dom!==e&&(r(),e=d.dom,u()),n=d.attrs.title,De===e&&(ve=n),s()},onbeforeremove(){o(),r()},view({attrs:d,children:h}){return h}}},$r=e=>e.replace(/\b\w/gi,t=>t.toUpperCase());var bi=(()=>`.smarttoc-dragmask{position:fixed;inset:0;z-index:100000000;background-color:green;opacity:.5;cursor:grabbing!important}
`)();const _r=()=>{let e,t,n,r;const s=document.createElement("div"),l="smarttoc-dragmask";s.className=l;const o=h=>{if(!t)return console.warn("target not ready");if(!e)return console.warn("handle not ready");if(r)return console.warn("already dragging?");const{clientX:g,clientY:m}=h;r={startRect:t.getBoundingClientRect(),start:{clientX:g,clientY:m}},document.addEventListener("mousemove",u),document.addEventListener("mouseup",d),e.style.cursor="grabbing",h.preventDefault()},u=h=>{if(!r)return console.warn("not dragging");if(!n)return console.warn("no vnode");const{clientX:g,clientY:m}=h,{start:M,startRect:{left:N,top:w,width:I,height:D}}=r;let j=N+(g-M.clientX),H=w+(m-M.clientY);const{innerWidth:P,innerHeight:E}=window;j=ce(0,j,P-I),H=ce(0,H,E-D),n.attrs.onPositionChange(j,H),h.preventDefault()},d=h=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",d),r=void 0,h.preventDefault(),e&&(e.style.cursor="")};return{oncreate(h){n=h,e=h.dom,t=h.attrs.target,e.addEventListener("mousedown",o)},onbeforeupdate(h,g){n=h,t=h.attrs.target},onbeforeremove(){e?.removeEventListener("mousedown",o)},view({attrs:h,children:g}){return g}}};var yi=(()=>`#smarttoc-base .toolbar{position:absolute;z-index:var(--zindex-toolbar);top:0;left:0;right:0;height:22px;display:flex;align-items:center;padding-right:10px;background:var(--background-color)}#smarttoc-base .toolbar .icon{width:20px;height:20px;background-size:16px 16px;background-repeat:no-repeat;background-position:center;opacity:.2;transition:opacity .3s ease-out}#smarttoc-base .toolbar .icon:hover,#smarttoc-base .toolbar .icon:focus-visible{opacity:.5}#smarttoc-base .toolbar .icon:active{opacity:.7}#smarttoc-base .toolbar .icon[disabled]{opacity:.1!important}#smarttoc-base .toolbar .drag-handle{flex-grow:1;cursor:grab;height:100%}#smarttoc-base .toolbar select{appearance:none;border:none;outline:none;box-shadow:none;padding:0;margin:0;font-family:inherit;font-size:inherit;cursor:pointer;line-height:inherit;background-color:transparent;color:transparent}#smarttoc-base .toolbar select option,#smarttoc-base .toolbar select optgroup{color:var(--text-color)}#smarttoc-base .toolbar .upgrade-guide{color:#888;opacity:.4;font-size:12px;margin-right:10px}#smarttoc-base .toolbar .upgrade-guide:hover{opacity:1}#smarttoc-base .toolbar .pro-feature{position:relative;display:flex;flex-direction:row}#smarttoc-base .toolbar .pro-feature .feature-hidden{pointer-events:none;display:flex;flex-direction:row}#smarttoc-base .toolbar .pro-feature .feature-tip{position:absolute;inset:0;cursor:pointer}#smarttoc-base .icon-search{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTcuMDQ1NDMgMi43NUM2LjE5NTg4IDIuNzUgNS4zNjU0IDMuMDAxOTIgNC42NTkwMiAzLjQ3MzkxQzMuOTUyNjQgMy45NDU5IDMuNDAyMDggNC42MTY3NSAzLjA3Njk3IDUuNDAxNjRDMi43NTE4NiA2LjE4NjUzIDIuNjY2OCA3LjA1MDE5IDIuODMyNTQgNy44ODM0M0MyLjk5ODI4IDguNzE2NjYgMy40MDczOCA5LjQ4MjAzIDQuMDA4MSAxMC4wODI4QzQuNjA4ODMgMTAuNjgzNSA1LjM3NDIgMTEuMDkyNiA2LjIwNzQzIDExLjI1ODNDNy4wNDA2NyAxMS40MjQxIDcuOTA0MzMgMTEuMzM5IDguNjg5MjIgMTEuMDEzOUM5LjQ3NDExIDEwLjY4ODggMTAuMTQ1IDEwLjEzODIgMTAuNjE3IDkuNDMxODRDMTEuMDg4OSA4LjcyNTQ2IDExLjM0MDkgNy44OTQ5OCAxMS4zNDA5IDcuMDQ1NDNDMTEuMzQwOCA1LjkwNjIzIDEwLjg4ODIgNC44MTM3MiAxMC4wODI3IDQuMDA4MThDOS4yNzcxNCAzLjIwMjY1IDguMTg0NjMgMi43NTAwNyA3LjA0NTQzIDIuNzVWMi43NVoiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8cGF0aCBkPSJNMTAgMTBMMTQgMTQiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8L3N2Zz4K)}#smarttoc-base[data-theme=dark] .icon-search{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTcuMDQ1NDMgMi43NUM2LjE5NTg4IDIuNzUgNS4zNjU0IDMuMDAxOTIgNC42NTkwMiAzLjQ3MzkxQzMuOTUyNjQgMy45NDU5IDMuNDAyMDggNC42MTY3NSAzLjA3Njk3IDUuNDAxNjRDMi43NTE4NiA2LjE4NjUzIDIuNjY2OCA3LjA1MDE5IDIuODMyNTQgNy44ODM0M0MyLjk5ODI4IDguNzE2NjYgMy40MDczOCA5LjQ4MjAzIDQuMDA4MSAxMC4wODI4QzQuNjA4ODMgMTAuNjgzNSA1LjM3NDIgMTEuMDkyNiA2LjIwNzQzIDExLjI1ODNDNy4wNDA2NyAxMS40MjQxIDcuOTA0MzMgMTEuMzM5IDguNjg5MjIgMTEuMDEzOUM5LjQ3NDExIDEwLjY4ODggMTAuMTQ1IDEwLjEzODIgMTAuNjE3IDkuNDMxODRDMTEuMDg4OSA4LjcyNTQ2IDExLjM0MDkgNy44OTQ5OCAxMS4zNDA5IDcuMDQ1NDNDMTEuMzQwOCA1LjkwNjIzIDEwLjg4ODIgNC44MTM3MiAxMC4wODI3IDQuMDA4MThDOS4yNzcxNCAzLjIwMjY1IDguMTg0NjMgMi43NTAwNyA3LjA0NTQzIDIuNzVWMi43NVoiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8cGF0aCBkPSJNMTAgMTBMMTQgMTQiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8L3N2Zz4K)}#smarttoc-base .icon-copy{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIuNSAxMi41VjUuNUMyLjUgNC4zOTU0MyAzLjM5NTQzIDMuNSA0LjUgMy41SDguNUM5LjYwNDU3IDMuNSAxMC41IDQuMzk1NDMgMTAuNSA1LjVWMTIuNUMxMC41IDEzLjYwNDYgOS42MDQ1NyAxNC41IDguNSAxNC41SDQuNUMzLjM5NTQzIDE0LjUgMi41IDEzLjYwNDYgMi41IDEyLjVaIiBzdHJva2U9ImJsYWNrIi8+CjxwYXRoIGQ9Ik01LjUgMy41QzUuNSAyLjM5NTQzIDYuMzk1NDMgMS41IDcuNSAxLjVIMTEuNUMxMi42MDQ2IDEuNSAxMy41IDIuMzk1NDMgMTMuNSAzLjVWMTAuNUMxMy41IDExLjYwNDYgMTIuNjA0NiAxMi41IDExLjUgMTIuNUgxMC41IiBzdHJva2U9ImJsYWNrIi8+Cjwvc3ZnPgo=)}#smarttoc-base[data-theme=dark] .icon-copy{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIuNSAxMi41VjUuNUMyLjUgNC4zOTU0MyAzLjM5NTQzIDMuNSA0LjUgMy41SDguNUM5LjYwNDU3IDMuNSAxMC41IDQuMzk1NDMgMTAuNSA1LjVWMTIuNUMxMC41IDEzLjYwNDYgOS42MDQ1NyAxNC41IDguNSAxNC41SDQuNUMzLjM5NTQzIDE0LjUgMi41IDEzLjYwNDYgMi41IDEyLjVaIiBzdHJva2U9IndoaXRlIi8+CjxwYXRoIGQ9Ik01LjUgMy41QzUuNSAyLjM5NTQzIDYuMzk1NDMgMS41IDcuNSAxLjVIMTEuNUMxMi42MDQ2IDEuNSAxMy41IDIuMzk1NDMgMTMuNSAzLjVWMTAuNUMxMy41IDExLjYwNDYgMTIuNjA0NiAxMi41IDExLjUgMTIuNUgxMC41IiBzdHJva2U9IndoaXRlIi8+Cjwvc3ZnPgo=)}#smarttoc-base .icon-menu{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTggOUM4LjU1MjI4IDkgOSA4LjU1MjI4IDkgOEM5IDcuNDQ3NzIgOC41NTIyOCA3IDggN0M3LjQ0NzcyIDcgNyA3LjQ0NzcyIDcgOEM3IDguNTUyMjggNy40NDc3MiA5IDggOVoiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik0xMiA5QzEyLjU1MjMgOSAxMyA4LjU1MjI4IDEzIDhDMTMgNy40NDc3MiAxMi41NTIzIDcgMTIgN0MxMS40NDc3IDcgMTEgNy40NDc3MiAxMSA4QzExIDguNTUyMjggMTEuNDQ3NyA5IDEyIDlaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBkPSJNNCA5QzQuNTUyMjggOSA1IDguNTUyMjggNSA4QzUgNy40NDc3MiA0LjU1MjI4IDcgNCA3QzMuNDQ3NzIgNyAzIDcuNDQ3NzIgMyA4QzMgOC41NTIyOCAzLjQ0NzcyIDkgNCA5WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==)}#smarttoc-base[data-theme=dark] .icon-menu{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTggOUM4LjU1MjI4IDkgOSA4LjU1MjI4IDkgOEM5IDcuNDQ3NzIgOC41NTIyOCA3IDggN0M3LjQ0NzcyIDcgNyA3LjQ0NzcyIDcgOEM3IDguNTUyMjggNy40NDc3MiA5IDggOVoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xMiA5QzEyLjU1MjMgOSAxMyA4LjU1MjI4IDEzIDhDMTMgNy40NDc3MiAxMi41NTIzIDcgMTIgN0MxMS40NDc3IDcgMTEgNy40NDc3MiAxMSA4QzExIDguNTUyMjggMTEuNDQ3NyA5IDEyIDlaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNCA5QzQuNTUyMjggOSA1IDguNTUyMjggNSA4QzUgNy40NDc3MiA0LjU1MjI4IDcgNCA3QzMuNDQ3NzIgNyAzIDcuNDQ3NzIgMyA4QzMgOC41NTIyOCAzLjQ0NzcyIDkgNCA5WiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg==)}#smarttoc-base .icon-theme-dark{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTUgNC4yNUM1IDMuMjkzMTIgNS4xNDA5NCAyLjMyNDY5IDUuNSAxLjVDMy4xMTE1NiAyLjUzOTY5IDEuNSA0Ljk3ODc1IDEuNSA3Ljc1QzEuNSAxMS40Nzc4IDQuNTIyMTkgMTQuNSA4LjI1IDE0LjVDMTEuMDIxMyAxNC41IDEzLjQ2MDMgMTIuODg4NCAxNC41IDEwLjVDMTMuNjc1MyAxMC44NTkxIDEyLjcwNjkgMTEgMTEuNzUgMTFDOC4wMjIxOSAxMSA1IDcuOTc3ODEgNSA0LjI1WiIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+Cjwvc3ZnPgo=)}#smarttoc-base .icon-theme-light{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzE2OV85Mjg2KSI+CjxwYXRoIGQ9Ik04IDEuNVYzLjVNOCAxMi41VjE0LjVNMTQuNSA4SDEyLjU5NjJNMy41IDhIMS41IiBzdHJva2U9ImJsYWNrIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS1saW5lY2FwPSJzcXVhcmUiLz4KPHBhdGggZD0iTTMuNDAzODEgMy40MDM4MUw0LjgxODAyIDQuODE4MDJNMTEuMTgyIDExLjE4MkwxMi41OTYyIDEyLjU5NjJNMTIuNTk2MiAzLjQwMzgxTDExLjI1IDQuNzQ5OTZNNC44MTgwMiAxMS4xODJMMy40MDM4MSAxMi41OTYyIiBzdHJva2U9ImJsYWNrIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS1saW5lY2FwPSJzcXVhcmUiLz4KPHBhdGggZD0iTTggMTAuNUM5LjM4MDcxIDEwLjUgMTAuNSA5LjM4MDcxIDEwLjUgOEMxMC41IDYuNjE5MjkgOS4zODA3MSA1LjUgOCA1LjVDNi42MTkyOSA1LjUgNS41IDYuNjE5MjkgNS41IDhDNS41IDkuMzgwNzEgNi42MTkyOSAxMC41IDggMTAuNVoiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+CjwvZz4KPGRlZnM+CjxjbGlwUGF0aCBpZD0iY2xpcDBfMTY5XzkyODYiPgo8cmVjdCB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9IndoaXRlIi8+CjwvY2xpcFBhdGg+CjwvZGVmcz4KPC9zdmc+Cg==)}#smarttoc-base .icon-heading-levels{width:20px;height:20px;background-size:16px 16px;background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMgNC41SDE0TTUgNy41SDkuNUgxNE03IDEwLjVIMTQiIHN0cm9rZT0iYmxhY2siLz4KPHBhdGggZD0iTTEgMTEuNUgzLjVNMy41IDExLjVINk0zLjUgMTEuNVY5TTMuNSAxMS41VjE0IiBzdHJva2U9ImJsYWNrIi8+Cjwvc3ZnPgo=);background-repeat:no-repeat;background-position:center}#smarttoc-base[data-theme=dark] .icon-heading-levels{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMgNC41SDE0TTUgNy41SDkuNUgxNE03IDEwLjVIMTQiIHN0cm9rZT0id2hpdGUiLz4KPHBhdGggZD0iTTEgMTEuNUgzLjVNMy41IDExLjVINk0zLjUgMTEuNVY5TTMuNSAxMS41VjE0IiBzdHJva2U9IndoaXRlIi8+Cjwvc3ZnPgo=)}#smarttoc-base .icon-auto{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMuNjQ1NTEgMTNMNy4yMTkyNCAzLjY5NDM0SDguNTQ1OUwxMi4zNTQ1IDEzSDEwLjk1MTdMOS44NjYyMSAxMC4xODE2SDUuOTc1MUw0Ljk1MzEyIDEzSDMuNjQ1NTFaTTYuMzMwNTcgOS4xNzg3MUg5LjQ4NTM1TDguNTE0MTYgNi42MDE1NkM4LjIxNzk0IDUuODE4NjggNy45OTc4OCA1LjE3NTQ2IDcuODU0IDQuNjcxODhDNy43MzU1MSA1LjI2ODU1IDcuNTY4MzYgNS44NjEgNy4zNTI1NCA2LjQ0OTIyTDYuMzMwNTcgOS4xNzg3MVoiIGZpbGw9ImJsYWNrIi8+Cjwvc3ZnPgo=)}#smarttoc-base .icon-fold{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyLjUgOEgzLjUiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8L3N2Zz4K)}#smarttoc-base .icon-expand{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyLjUgOEgzLjVNOCAzLjVWMTIuNVYzLjVaIiBzdHJva2U9ImJsYWNrIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPC9zdmc+Cg==)}#smarttoc-base[data-theme=dark] .icon-auto{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMuNjQ1NTEgMTNMNy4yMTkyNCAzLjY5NDM0SDguNTQ1OUwxMi4zNTQ1IDEzSDEwLjk1MTdMOS44NjYyMSAxMC4xODE2SDUuOTc1MUw0Ljk1MzEyIDEzSDMuNjQ1NTFaTTYuMzMwNTcgOS4xNzg3MUg5LjQ4NTM1TDguNTE0MTYgNi42MDE1NkM4LjIxNzk0IDUuODE4NjggNy45OTc4OCA1LjE3NTQ2IDcuODU0IDQuNjcxODhDNy43MzU1MSA1LjI2ODU1IDcuNTY4MzYgNS44NjEgNy4zNTI1NCA2LjQ0OTIyTDYuMzMwNTcgOS4xNzg3MVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=)}#smarttoc-base[data-theme=dark] .icon-fold{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyLjUgOEgzLjUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8L3N2Zz4K)}#smarttoc-base[data-theme=dark] .icon-expand{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyLjUgOEgzLjVNOCAzLjVWMTIuNVYzLjVaIiBzdHJva2U9IndoaXRlIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPC9zdmc+Cg==)}#smarttoc-base .toolbar{opacity:0;transition:opacity .3s ease-out}#smarttoc-base:hover .toolbar,#smarttoc-base:focus-within .toolbar{opacity:1}
`)(),Ve=(e=>(e.openOptionsPage="openOptionsPage",e.copyAsText="copyAsText",e.copyAsHtml="copyAsHtml",e.copyAsJson="copyAsJson",e))(Ve||{});const bt=()=>({view({attrs:e,children:t}){if(e.enabled)return t;if(!!e.promoteProFeature)return x(".pro-feature",[x(".feature-hidden",t),x(be,{title:x("",[x("p",`${e.name} (Pro feature)`)])},[x(".feature-tip",{onclick:e.onClick})])])}}),Xr=()=>({view({attrs:{content:e,context:t,expandSetting:n,onExpandSettingChange:r}}){return e.maxLevel<=1?[]:[n.type!=="auto"&&x(be,{title:"Auto Expand"},x("button.icon.icon-auto",{type:"button",onclick:()=>r({type:"auto"})})),x(be,{title:"Expand Less"},[x("button.icon.icon-fold",{type:"button",disabled:e.maxLevel<=1||n.type==="fixed"&&n.level===1,onclick:()=>{const s=n.type==="fixed"?n.level:void 0,l=s==null?t.getMaxExpandedLevel()-1:s-1;r({type:"fixed",level:Math.max(1,l)})}})]),x(be,{title:"Expand More"},[x("button.icon.icon-expand",{type:"button",disabled:e.maxLevel<=1||n.type==="fixed"&&n.level===e.maxLevel,onclick:()=>{const s=n.type==="fixed"?n.level:void 0,l=s==null?t.getMaxExpandedLevel():s+1;r({type:"fixed",level:Math.min(e.maxLevel,l)})}})])]}}),Kr=()=>({view({attrs:{features:e,content:t,context:n,background:r,expandSetting:s,onOpenOptions:l,onExpandSettingChange:o,onThemeChange:u,onToggleSearch:d,onPositionChange:h,onCopyHeadings:g,container:m}}){const M=ae.theme??"light";e.shouldPromoteProFeature();const N=()=>{r.openOptionsPage()};return x(".toolbar",{role:"toolbar"},[x(_r,{target:m,onPositionChange:h},[x(".drag-handle")]),t&&[x(bt,{enabled:e.customExpand(),name:"Custom Expand",desc:"up to 6 heading levels",promoteProFeature:e.shouldPromoteProFeature(),onClick:N},[x(Xr,{content:t,context:n,expandSetting:s,onExpandSettingChange:e.customExpand()?o:pe})]),x(bt,{enabled:e.search(),name:"Search",promoteProFeature:e.shouldPromoteProFeature(),onClick:N},[x(be,{title:"Search"},[x("button.icon.icon-search",{type:"button",onclick:e.search()?d:pe})])]),x(bt,{enabled:e.darkMode(),name:"Theme",desc:"auto switch to dark theme for dark pages",promoteProFeature:e.shouldPromoteProFeature(),onClick:N},[x(be,{title:`Theme: ${$r(M)}`},x("button.icon.icon-theme",{type:"button",class:`icon-theme-${M}`,onclick:()=>e.darkMode()&&u(M==="dark"?"light":"dark")}))]),x(be,{title:"Menu"},[x("select.icon.icon-menu",{name:"menu",value:"none",onchange(w){const I=w.target.value;switch(I){case"openOptionsPage":{l();break}case"copyAsHtml":case"copyAsText":case"copyAsJson":{e.copyToClipboard()?g(I):e.shouldPromoteProFeature()&&l();break}}}},[x("option",{value:"placeholder",disabled:!0},""),x("option",{value:"openOptionsPage"},"Open Options Page"),(e.copyToClipboard()||e.shouldPromoteProFeature())&&x("optgroup",{label:e.copyToClipboard()?"Copy...":"Copy (Pro feature)"},[{value:"copyAsText",text:"Copy as Plain Text"},{value:"copyAsHtml",text:"Copy as Rich Text"},{value:"copyAsJson",text:"Copy as Json"}].map(w=>x("option",{value:w.value},w.text)))])])]])}}),qr=async e=>{const n="smarttoc-heading",r="smarttoc-heading--is-active";e.classList.add(n),await xe(0),e.classList.add(r),await xe(300),await xe(100),e.classList.remove(r),await xe(300),e.classList.remove(n)},ei=({headings:e,activeHeading:t,measurements:n,search:r})=>{const s=Qe({level:-1});if(e.forEach((o,u)=>{Pt({tree:s,value:{heading:o,level:o.level,rect:n.headingRects[u]},level:o.level+1,defaultValue:d=>({level:d.value.level+1})})}),t!=null)for(const o of rt(s)){const u=o.value.heading;if(u&&u.index===t){o.value.active=!0;for(const d of Ot(o))d.value.containsActive=!0;break}}let l=[];if(r!=null){const o=r.toLowerCase();for(const u of rt(s)){const d=u.value.heading;if(!!d&&d.text.toLowerCase().includes(o)){u.value.match=!0,l.push(u);for(const h of Ot(u))h.value.containsMatch=(h.value.containsMatch||0)+1}}}return{tree:s,found:l}};let de=0,yn=!1,ye=30;const ti=e=>{const t=new Yr({spaceFromTop:ye+de}),n=new Pr({spaceFromTop:ye+de}),r=new Sr,s=new fe({spaceFromTop:ye+de+(t.measurements?.scrollerRect?.top??0)});let l,o="",u=!1,d=!1,h={type:"auto"};const g=e.attrs.features,m=b=>{b!==de&&(de=b,yn=!0,n.setOptions({spaceFromTop:ye+de}),t.setOptions({spaceFromTop:ye+de}),s.setSpaceFromTop(ye+de+(t.measurements?.scrollerRect?.top??0)))},M=()=>{const{content:b,measurements:z}=t;if(n.setOptions({content:b,measurements:z,spaceFromTop:ye+de}),g.darkMode()&&!ae.themePage){const T=t.content?.headings[0].dom;if(T){const A=ae.detectPageTheme(T);ae.themePage=A,ae.theme==null&&ae.updateTheme(ae.themePage)}}s.setArticle(t.content?.article),b||r.reset(),x.redraw()},N=()=>{if(x.redraw.sync(),d||!l)return;const b=t.activeHeading;if(b==null)return;const z=l.querySelector(`.heading-text-position-holder[data-index="${b}"]`);!z||z.scrollIntoView({block:"center",inline:"center"})},w=b=>{if(yn||!t.content)return;const z=ue.detectHeaderHeight({watcher:t})??0;m(z),z&&b!=null&&t.scrollToHeading(b)};t.on("activeHeadingChanged",N),t.on("articleChanged",M),t.on("headingsChanged",M),t.on("measurementsChanged",M),t.on("scrolledToHeading",w),M(),w();const I=b=>{const z=g.maxLevel(),T=t.content;if(b.value.level+1>=z)return!1;if(d)return;if(!b.children?.length)return!1;if(u&&o)return!0;const A=!0;switch(h.type){case"fixed":return b.value.level+1<h.level;case"auto":return!T?.headings.length||T.headings.length<=50?A:Boolean(b.value.level===-1||b.value.active||b.value.containsActive);case"custom":return r.isExpanded(b.path);default:return Pn(h)}},D=b=>g.customExpand()?Boolean(b.children?.length):!1,j=b=>{h.type!=="custom"&&(h={type:"custom"}),r.expand(b.path),x.redraw()},H=b=>{h.type!=="custom"&&(h={type:"custom"}),r.fold(b.path),x.redraw()},P=b=>u&&o?b.value.match||Boolean(b.value.containsMatch):!0,E=async({headingIndex:b,highlight:z=!0,animation:T=!0})=>{const A=t.content?.headings[b];A&&(d=!1,x.redraw(),await t.scrollToHeading(b,T?void 0:0),d=!1,x.redraw(),z&&qr(A.dom))},k=async(b,z,T)=>{const Q=(te=>{for(let ne=0;ne<3;ne++){if(te.dataset.index!=null)return te;te=te.parentElement}})(b);if(!Q)return;const Y=Number(Q.dataset.index);Number.isNaN(Y)||await E({headingIndex:Y,highlight:z,animation:T})};return{oncreate(b){l=b.dom,t.updateMeasurements(!0),s.setPanel(l),s.setArticle(t.content?.article);const z={async goToNextHeading(){const T=t.getNextHeadingIndex();T!=null&&await E({headingIndex:T,highlight:!0,animation:!1})},async goToPreviousHeading(){const T=t.getPreviousHeadingIndex();T!=null&&await E({headingIndex:T,highlight:!0,animation:!1})}};b.attrs.onMount(z)},onremove(b){n.dispose(),t.dispose(),s.dispose(),n.dispose(),b.attrs.onUnmount()},view({attrs:{background:b}}){const{content:z,activeHeading:T,measurements:A}=t,Q=z&&A&&ei({headings:z.headings,activeHeading:T,measurements:A,search:u&&o?o:void 0}),Y=Q?.tree,te=Q?.found??[],ne={isExpanded(L){const G=I(L);return G!=null&&G!==r.isExpanded(L.path)&&(G?r.expand(L.path):r.fold(L.path)),G},getMaxExpandedLevel(){return r.getMaxExpandedLevel()},canExpand:D,shouldShow:P,expand:j,fold:H,breadcrumb:g.breadcrumb(),search:o,isSearchActive:u};return x("nav.smarttoc-panel",{id:gt,"aria-label":"smarttoc webpage outline","tab-index":0,"data-theme":ae.theme,style:{visibility:s.isPositioned()?"visible":"hidden"},onmouseleave(){const L=document.activeElement;typeof L.dataset.index=="string"&&L.blur()}},[x(Kr,{features:g,content:z,background:b,container:l,expandSetting:h,context:ne,async onOpenOptions(){await b.openOptionsPage()},onExpandSettingChange:L=>{h=L},onThemeChange(L){ae.updateTheme(L)},onPositionChange(L,G){s.setAbsPos({x:L,y:G,width:fe.absPos?.width,height:fe.absPos?.height})},onToggleSearch(){u=!u},async onCopyHeadings(L){switch(L){case Ve.copyAsText:{const G=t.content;if(!G)return;const{headings:oe}=G,se=oe.map(re=>"  ".repeat(re.level)+"- "+re.text).join(`
`);cn(se);break}case Ve.copyAsHtml:{const G=t.content;if(!G)return;const{headings:oe}=G;if(oe.map(me=>me.text).join(`
`),!Y?.children)return;const se=document.createElement("div"),re=me=>x("ol",me.children?.map(He=>x("li",[He.value.heading?.text,...He.children?.length?[re(He)]:[]])));x.render(se,re(Y));const Se=se.outerHTML;Lr(Se);break}case Ve.copyAsJson:{if(!Y?.children)return;const G=re=>({level:re.value.level,text:re.value.heading?.text,anchor:re.value.heading?.anchor?.substring(1),children:re.children?.map(G)}),oe=Y.children.map(G),se=JSON.stringify(oe,null,2);cn(se);break}}}}),g.search()&&x(Vr,{isActive:u,search:o,onInput(L){o=L.target.value},onClose(){u=!1}}),x(".contents-wrapper",[x(".contents",{onclick:async L=>{L.preventDefault(),k(L.target),L.redraw=!1},...g.glance()&&{onmouseover:L=>{L.altKey&&k(L.target,!1,!1),L.redraw=!1}}},[u&&o&&te.length===0?x(".empty-placeholder","Not found"):Y?.children?x(bn,{nodes:Y?.children,context:ne}):x(".empty-placeholder","Can not locate article/headings")])]),g.resize()&&Q!=null&&x(Gr,{minWidth:100,minHeight:100,onChange(L){s.setAbsPos({x:L.left,y:L.top,width:L.width,height:L.height})}})])}}};class ni{constructor(t){this.product=t.product,this.hideProFeature=t.hideProFeature}shouldPromoteProFeature(){return!this.hideProFeature}isPro(){return this.product==="pro"}breadcrumb(){return this.isPro()}search(){return this.isPro()}maxLevel(){return this.isPro()?6:2}darkMode(){return this.isPro()}copyToClipboard(){return this.isPro()}customExpand(){return this.isPro()}resize(){return this.isPro()}glance(){return this.isPro()}}const In=Ct?new zr({}):new Cr({});q&&(window.st_store=In);const Nn=Ct?Tr():vr();class ri extends Le{constructor(){super(),ke(this,"runner"),this.start()}async start(){const t=S.getContainer("smarttoc-container"),{productInfo:n,config:r}=await In.get();Nn.checkProductStatusIfNeeded().catch(u=>{console.error("[smarttoc] check product status failed: ",u)});const s=Er.getPrivilegeType(n),l=r?.hideProFeatures??!1,o=new ni({product:s.type,hideProFeature:l});x.mount(t,{view:()=>x(ti,{features:o,onMount:u=>{this.handle=u},onUnmount:()=>{this.handle=void 0},background:Nn})}),this.R(()=>x.mount(t,null))}}if(!window.smarttoc){const e=he("boot");e("injected"),window.smarttoc={};const t=ue.detectMainWindow();if(window===t){let n;const r=()=>{n&&(e("stop"),n.dispose(),n=void 0)},s=()=>{e("start"),r(),n=new ri};s(),chrome.runtime.onMessage.addListener((l,o,u)=>{try{switch(l){case"toggle":{n?r():s();break}case"prev":{n||s(),n?.handle?.goToPreviousHeading();break}case"next":{n||s(),n?.handle?.goToNextHeading();break}default:console.warn("unknown request",l);break}u(!0)}catch(d){console.error("[smarttoc] failed to handle message: ",l,d),u(!1)}})}}})();
